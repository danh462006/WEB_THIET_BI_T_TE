<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n Tr·ªã Vi√™n - Th√¥ng Tin - TBYT ƒê·ª©c Ph∆∞∆°ng</title>
    <link rel="icon" type="image/png" href="hinh-anh/logo-favicon.png">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="category-style.css">
    <link rel="stylesheet" href="profile-modal.css">
    <link rel="stylesheet" href="mobile-responsive.css">
    <script src="auth-redirect.js"></script>
    <script src="profile-modal.js"></script>
    <style>
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .modal-content {
            animation: fadeInDown 0.4s ease-out;
        }

        /* CSS cho giao di·ªán Qu·∫£n tr·ªã vi√™n */
        .admin-edit-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background-color: #ffc107;
            color: #000;
            border: 1px solid #d39e00;
            border-radius: 4px;
            padding: 2px 6px;
            font-size: 11px;
            font-weight: bold;
            cursor: pointer;
            margin-left: 8px;
            z-index: 9999;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            transition: all 0.2s;
            text-decoration: none !important;
            white-space: nowrap;
        }
        .admin-edit-btn:hover {
            background-color: #e0a800;
            transform: scale(1.05);
        }
        
        /* Style cho n√∫t s·ª≠a ·∫£nh (n·∫±m ƒë√® l√™n ·∫£nh) */
        .admin-edit-btn-img {
            position: absolute;
            top: 10px;
            right: 10px;
            opacity: 0.8;
        }
        .admin-edit-btn-img:hover {
            opacity: 1;
        }

        /* Overlay khi kh√¥ng c√≥ quy·ªÅn truy c·∫≠p */
        #accessDeniedOverlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: white;
            z-index: 10000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        /* CSS cho modal ch·ªânh s·ª≠a ·∫£nh */
        .image-edit-modal-content {
            padding: 20px 30px;
            text-align: left;
        }
        .image-edit-modal-content h2 {
            text-align: center;
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 20px;
        }
        .image-edit-modal-content label {
            display: block;
            margin-top: 15px;
            margin-bottom: 5px;
            font-weight: 500;
        }
        .image-edit-modal-content input[type="file"],
        .image-edit-modal-content input[type="text"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        .progress-bar-container {
            width: 100%;
            background-color: #e9ecef;
            border-radius: 5px;
            margin-top: 20px;
            overflow: hidden;
            display: none; /* ·∫®n ban ƒë·∫ßu */
        }
        .progress-bar {
            width: 0%;
            height: 24px;
            background-color: #4CAF50;
            text-align: center;
            line-height: 24px;
            color: white;
            font-weight: bold;
            border-radius: 5px;
            transition: width 0.3s ease-in-out;
        }
        #updateImageBtn {
            margin-top: 15px;
            background-color: #28a745; /* M√†u xanh l√° c√¢y ƒë·∫≠m h∆°n */
        }
        /* Textarea trong modal s·ª≠a vƒÉn b·∫£n */
        #textEditInput {
            min-height: 100px;
            resize: vertical;
        }
        /* Path preview styling */
        #pathPreview {
            font-size: 13px;
            word-break: break-all;
        }
        #pathPreviewText {
            color: #0066cc;
            font-family: monospace;
        }
        #customFolderDiv {
            margin-top: 10px;
        }

        /* ================== CSS t·ª´ thong-tin.html ================== */
        body {
            margin: 0;
            padding: 0;
        }
        .info-container {
            width: 100%;
            margin: 0;
            padding: 20px;
            background-image: url('hinh-thongtin/nen-thongtin.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            min-height: 400px;
        }
        .info-layout {
            display: flex;
            gap: 30px;
            align-items: flex-start;
            max-width: 1200px;
            margin: 0 auto;
        }
        .info-left {
            flex: 1;
        }
        .info-left img {
            width: 100%;
            height: auto;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .info-right {
            flex: 0.7;
        }
        .info-right img {
            width: 100%;
            height: auto;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .intro-section-container {
            padding: 40px 20px;
            max-width: 1200px;
            margin: 20px auto;
            background-color: #f9f9f9;
            border-radius: 10px;
        }
        .intro-section-flex {
            display: flex;
            align-items: center;
            gap: 40px;
        }
        .intro-text {
            flex: 2;
        }
        .intro-text h3 {
            font-size: 24px;
            color: #2c3e50;
            margin-bottom: 20px;
            font-weight: 600;
            padding-bottom: 15px;
            border-bottom: 2px solid #aceaae;
        }
        .intro-text p {
            font-size: 18px;
            line-height: 1.8;
            color: #34495e;
            margin: 0 0 15px 0;
        }
        .intro-image {
            flex: 1;
            text-align: center;
        }
        .intro-image img {
            max-width: 220px;
            height: auto;
            border-radius: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        .intro-image img:hover {
            transform: scale(1.05);
        }

        .section-divider {
            display: flex;
            align-items: center;
            text-align: center;
            margin: 40px 20px;
            color: #2c3e50;
        }
        .section-divider span {
            font-size: 22px;
            font-weight: 600;
            padding: 0 20px;
            text-transform: uppercase;
        }
        .section-divider::before,
        .section-divider::after {
            content: '';
            flex: 1;
            border-bottom: 3px solid #aceaae;
        }

        .product-card-container {
            display: flex;
            justify-content: flex-start;
            padding: 0px 20px;
        }

        .product-card-container-reversed {
            display: flex;
            justify-content: flex-end;
            padding: 0px 20px;
        }

        .product-card {
            width: 50%;
            display: flex;
            background-color: #fff;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border-radius: 10px;
            border-top-right-radius: 150px;
            border-bottom-right-radius: 150px;
            overflow: hidden;
            transition: transform 0.3s ease;
        }

        .product-card-reversed {
            width: 50%;
            display: flex;
            background-color: #fff;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border-radius: 10px;
            border-top-left-radius: 150px;
            border-bottom-left-radius: 150px;
            overflow: hidden;
            transition: transform 0.3s ease;
        }

        .product-card:hover, .product-card-reversed:hover {
            transform: translateY(-5px);
        }

        .product-card-text {
            flex: 3;
            padding: 30px;
        }
        .product-card-text h3 {
            font-size: 22px;
            color: #2c3e50;
            margin-top: 0;
        }
        .product-card-text ul {
            list-style: none;
            padding-left: 0;
        }
        .product-card-text p {
            line-height: 1.8;
            margin-bottom: 15px;
        }
        .product-card-text li {
            margin-bottom: 10px;
            line-height: 1.6;
        }
        .product-card-image {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .product-card-image img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .product-card-reversed .product-card-image img {
            transform: translateX(20px);
        }

        @media (max-width: 992px) {
            .product-card, .product-card-reversed {
                width: 80%;
            }
        }

        @media (max-width: 768px) {
            .product-card-container, .product-card-container-reversed {
                justify-content: center;
            }
            .product-card, .product-card-reversed {
                width: 100%;
                flex-direction: column;
                border-radius: 20px;
            }
            .product-card-image {
                order: -1;
                min-height: 200px;
            }
            .product-card-reversed .product-card-image img {
                transform: none;
            }

            /* Animation cho Mobile Menu */
            @keyframes slideUpMenu {
                from { opacity: 0; transform: translateY(20px); }
                to { opacity: 1; transform: translateY(0); }
            }

            .dropdown.mobile-menu-active .dropdown-content {
                display: block;
                animation: slideUpMenu 0.3s ease forwards;
                /* ƒê·∫£m b·∫£o menu ch·ªâ cao v·ª´a ƒë·ªß n·ªôi dung (ngay d∆∞·ªõi m·ª•c Tin t·ª©c) */
                height: auto;
                max-height: 70vh; /* Gi·ªõi h·∫°n chi·ªÅu cao n·∫øu danh s√°ch qu√° d√†i */
                overflow-y: auto;
            }

            /* Responsive overrides for Exhibition Section (4 slides) */
            .exhibition-section .project-track {
                width: 400% !important;
            }
            .exhibition-section .project-slide {
                flex: 0 0 25% !important;
                width: 25% !important;
            }
        }

        @media (max-width: 768px) {
            .info-layout {
                flex-direction: column;
            }
            .intro-section-flex {
                flex-direction: column;
                text-align: center;
                gap: 20px;
            }
        }

        /* Exhibition Section Styles (4 slides) */
        .exhibition-section .project-track {
            width: 400%;
        }
        .exhibition-section .project-slide {
            flex: 0 0 25%;
            width: 25%;
        }

        /* T·ªëi ∆∞u kho·∫£ng c√°ch cho ph·∫ßn tri·ªÉn l√£m v√† d·ª± √°n */
        .exhibition-section {
            padding: 10px 0 !important;
        }
        .exhibition-section h2 {
            margin-bottom: 10px !important;
            margin-top: 0 !important;
        }
        .exhibition-section .projects-form {
            padding-top: 10px !important;
            padding-bottom: 10px !important;
        }

        /* Factory Section Styles (3 slides) override exhibition-section 4 slides */
        #factory-section .project-track {
            width: 300% !important;
        }
        #factory-section .project-slide {
            flex: 0 0 33.333% !important;
            width: 33.333% !important;
        }
    </style>
</head>
<style>
.admin-banner {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 15px 20px;
    text-align: center;
    font-weight: bold;
    position: relative;
}
</style>
<body>
    <div class="admin-banner">‚öôÔ∏è QU·∫¢N TR·ªä VI√äN - CH·ªà D√ÄNH CHO NH√ÇN VI√äN ƒê·ª©c Ph∆∞∆°ng</div>
    <!-- Profile Modal System -->
    <div id="profileModal" class="profile-modal" style="display: none;">
        <div class="profile-modal-content">
            <span class="profile-close" onclick="closeProfileModal()">&times;</span>
            <h2>Th√¥ng tin t√†i kho·∫£n</h2>
            <div class="profile-avatar-section">
                <img id="profileAvatar" src="hinh-anh/hinh-tk-macdinh.png" alt="Avatar" class="profile-avatar-img">
                <input type="file" id="avatarInput" accept="image/*" style="display: none;" onchange="handleAvatarUpload(event)">
                <button class="profile-btn-secondary" onclick="document.getElementById('avatarInput').click()">Ch·ªânh s·ª≠a avatar</button>
            </div>
            <div class="profile-info-section">
                <div class="profile-field"><label>T√™n ng∆∞·ªùi d√πng:</label><input type="text" id="profileUsername" class="profile-input" readonly><button class="profile-btn-edit" onclick="enableEdit('profileUsername')">‚úèÔ∏è</button></div>
                <div class="profile-field"><label>S·ªë ƒëi·ªán tho·∫°i:</label><input type="text" id="profilePhone" class="profile-input" readonly><button class="profile-btn-change" onclick="openChangePhoneModal()">Thay ƒë·ªïi</button></div>
                <div class="profile-field"><label>Email:</label><input type="email" id="profileEmail" class="profile-input" readonly><button class="profile-btn-change" onclick="openChangeEmailModal()">Thay ƒë·ªïi</button></div>
                <div class="profile-field"><label>M·∫≠t kh·∫©u:</label><div style="position: relative;"><input type="password" id="profilePassword" class="profile-input" value="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" readonly><span onclick="togglePasswordVisibility()" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); cursor: pointer; font-size: 20px;">üëÅÔ∏è</span></div><a href="#" class="profile-link-change" onclick="openChangePasswordModal(); return false;">Thay ƒë·ªïi m·∫≠t kh·∫©u</a></div>
                <div class="profile-field"><label>ƒê·ªãa ch·ªâ:</label><textarea id="profileAddress" class="profile-textarea" rows="3"></textarea></div>
                <button class="profile-btn-primary" onclick="saveProfileChanges()">L∆∞u thay ƒë·ªïi</button>
            </div>
        </div>
    </div>
    <div id="changePasswordModal" class="profile-modal" style="display: none;">
        <div class="profile-modal-content profile-modal-small">
            <span class="profile-close" onclick="closeChangePasswordModal()">&times;</span>
            <h3>Thay ƒë·ªïi m·∫≠t kh·∫©u</h3>
            <div class="profile-field"><label>M·∫≠t kh·∫©u c≈©:</label><input type="password" id="oldPassword" class="profile-input"></div>
            <div class="profile-field"><label>M·∫≠t kh·∫©u m·ªõi:</label><input type="password" id="newPassword" class="profile-input"></div>
            <div class="profile-field"><label>M√£ x√°c nh·∫≠n:</label><div style="display: flex; gap: 10px;"><input type="text" id="passwordVerifyCode" class="profile-input" style="flex: 1;"><button class="profile-btn-secondary" onclick="sendPasswordVerificationCode()">G·ª≠i m√£</button></div><small style="color: #666;">M√£ x√°c nh·∫≠n s·∫Ω ƒë∆∞·ª£c g·ª≠i ƒë·∫øn email c·ªßa b·∫°n</small></div>
            <button class="profile-btn-primary" onclick="updatePassword()">C·∫≠p nh·∫≠t m·∫≠t kh·∫©u</button>
        </div>
    </div>
    <div id="changePhoneModal" class="profile-modal" style="display: none;">
        <div class="profile-modal-content profile-modal-small">
            <span class="profile-close" onclick="closeChangePhoneModal()">&times;</span>
            <h3>Thay ƒë·ªïi s·ªë ƒëi·ªán tho·∫°i</h3>
            <div class="profile-field"><label>S·ªë ƒëi·ªán tho·∫°i m·ªõi:</label><input type="text" id="newPhone" class="profile-input"></div>
            <div class="profile-field"><label>M√£ x√°c nh·∫≠n:</label><div style="display: flex; gap: 10px;"><input type="text" id="phoneVerifyCode" class="profile-input" style="flex: 1;"><button class="profile-btn-secondary" onclick="sendPhoneVerificationCode()">G·ª≠i m√£</button></div><small style="color: #666;">M√£ x√°c nh·∫≠n s·∫Ω ƒë∆∞·ª£c g·ª≠i ƒë·∫øn SƒêT m·ªõi</small></div>
            <button class="profile-btn-primary" onclick="updatePhone()">C·∫≠p nh·∫≠t SƒêT</button>
        </div>
    </div>
    <div id="changeEmailModal" class="profile-modal" style="display: none;">
        <div class="profile-modal-content profile-modal-small">
            <span class="profile-close" onclick="closeChangeEmailModal()">&times;</span>
            <h3>Thay ƒë·ªïi Email</h3>
            <div class="profile-field"><label>Email m·ªõi:</label><input type="email" id="newEmail" class="profile-input"></div>
            <div class="profile-field"><label>M√£ x√°c nh·∫≠n:</label><div style="display: flex; gap: 10px;"><input type="text" id="emailVerifyCode" class="profile-input" style="flex: 1;"><button class="profile-btn-secondary" onclick="sendEmailVerificationCode()">G·ª≠i m√£</button></div><small style="color: #666;">M√£ x√°c nh·∫≠n s·∫Ω ƒë∆∞·ª£c g·ª≠i ƒë·∫øn email m·ªõi</small></div>
            <button class="profile-btn-primary" onclick="updateEmail()">C·∫≠p nh·∫≠t Email</button>
        </div>
    </div>

    <!-- Overlay ki·ªÉm tra quy·ªÅn (M·∫∑c ƒë·ªãnh ·∫©n, hi·ªán l√™n n·∫øu check th·∫•t b·∫°i) -->
    <div id="accessDeniedOverlay" style="display: none;">
        <h1 style="color: red;">Truy c·∫≠p b·ªã t·ª´ ch·ªëi</h1>
        <p>B·∫°n kh√¥ng c√≥ quy·ªÅn truy c·∫≠p trang qu·∫£n tr·ªã n√†y.</p>
        <button onclick="window.location.href='thong-tin.html'" style="padding: 10px 20px; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer; margin-top: 20px;">V·ªÅ trang Th√¥ng Tin</button>
        <button onclick="toggleLoginForm(); document.getElementById('accessDeniedOverlay').style.display='none';" style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; margin-top: 10px;">ƒêƒÉng nh·∫≠p l·∫°i</button>
    </div>

    <header class="header">
        <div class="container">
            <div class="logo-section">
                <img src="hinh-anh/logo.png" alt="TBYT ƒê·ª©c Ph∆∞∆°ng" class="logo">
            </div>
            
            <div class="search-section">
                <div class="search-box">
                    <input type="text" placeholder="T√¨m Ki·∫øm ..." class="search-input" autocomplete="off">
                    <button class="search-btn">üîç</button>
                </div>
                <div class="search-suggestions" id="searchSuggestions"></div>
            </div>
            
            <div class="user-section">
                <div class="account-dropdown">
                    <button class="account-btn" onclick="handleAccountClick(event)">
                        <img src="hinh-anh/icon_tk.png" alt="T√†i kho·∫£n" class="account-icon">
                    </button>
                    <div id="usernameDisplay" class="username-display" style="display: none;"></div>
                    <div class="account-menu" id="accountMenu" style="min-width: 150px; right: 0; left: auto;">
                        <a href="#" onclick="event.stopPropagation(); openProfileModal(); return false;">Th√¥ng tin t√†i kho·∫£n</a>
                        <a href="#">ƒê∆°n h√†ng c·ªßa t√¥i</a>
                        <a href="#" onclick="handleLogout(); return false;">ƒêƒÉng xu·∫•t</a>
                    </div>
                </div>
                <button class="cart-btn">üõí Gi·ªè h√†ng</button>
                <div class="dropdown">
                    <button class="dropdown-btn">üìã Danh m·ª•c ‚ñº</button>
                    <div class="dropdown-content">
                        <a href="index.html">Trang ch·ªß</a>
                        <div class="dropdown-item-with-submenu">
                            <a href="#" class="has-submenu">S·∫£n ph·∫©m</a>
                            <div class="submenu">
                                <div class="submenu-content">
                                    <div class="category-header">
                                        <h3>üî• G·ª£i √Ω cho b·∫°n</h3>
                                    </div>
                                    
                                    <div class="category-brands">
                                        <div class="brand-item" data-category="Gi∆∞·ªùng"><img src="icon-hinhdanhmuc/nhom-giuong.png" alt="Gi∆∞·ªùng" class="category-icon">Gi∆∞·ªùng</div>
                                        <div class="brand-item" data-category="Xe lƒÉn"><img src="icon-hinhdanhmuc/nhom-xelan.png" alt="Xe lƒÉn" class="category-icon">Xe lƒÉn</div>
                                        <div class="brand-item" data-category="Xe Scooter ƒëi·ªán"><img src="icon-hinhdanhmuc/nhom-xedien.png" alt="Xe Scooter ƒëi·ªán" class="category-icon">Xe Scooter ƒëi·ªán</div>
                                        <div class="brand-item" data-category="BƒÉng ca"><img src="icon-hinhdanhmuc/nhom-bangca.png" alt="BƒÉng ca" class="category-icon">BƒÉng ca</div>
                                        <div class="brand-item" data-category="T·ªß"><img src="icon-hinhdanhmuc/nhom-tu.png" alt="T·ªß" class="category-icon">T·ªß</div>
                                        <div class="brand-item" data-category="M√°y t·∫°o oxy"><img src="icon-hinhdanhmuc/nhom-maytaooxy.png" alt="M√°y t·∫°o oxy" class="category-icon">M√°y t·∫°o oxy</div>
                                        <div class="brand-item" data-category="M√°y ƒëo"><img src="icon-hinhdanhmuc/nhom-maydo.png" alt="M√°y ƒëo" class="category-icon">M√°y ƒëo</div>
                                        <div class="brand-item" data-category="M√°y x√¥ng"><img src="icon-hinhdanhmuc/nhom-xong.png" alt="M√°y x√¥ng" class="category-icon">M√°y x√¥ng</div>
                                        <div class="brand-item" data-category="M√°y h√∫t d·ªãch"><img src="icon-hinhdanhmuc/nhom-mayhutdich.png" alt="M√°y h√∫t d·ªãch" class="category-icon">M√°y h√∫t d·ªãch</div>
                                        <div class="brand-item" data-category="M√°y massage"><img src="icon-hinhdanhmuc/nhom-massage.png" alt="M√°y massage" class="category-icon">M√°y massage</div>
                                        <div class="brand-item" data-category="Thi·∫øt b·ªã t·∫≠p"><img src="icon-hinhdanhmuc/nhom-maytap.png" alt="Thi·∫øt b·ªã t·∫≠p" class="category-icon">Thi·∫øt b·ªã t·∫≠p</div>
                                        <div class="brand-item" data-category="N·ªám"><img src="icon-hinhdanhmuc/nhom-nem.png" alt="N·ªám" class="category-icon">N·ªám</div>
                                        <div class="brand-item" data-category="D·ª•ng c·ª• h·ªó tr·ª£"><img src="icon-hinhdanhmuc/nhom-dungcuhotro.png" alt="D·ª•ng c·ª• h·ªó tr·ª£" class="category-icon">D·ª•ng c·ª• h·ªó tr·ª£</div>
                                        <div class="brand-item" data-category="Thi·∫øt b·ªã y t·∫ø kh√°c"><img src="icon-hinhdanhmuc/nhom-thietbiyte.png" alt="Thi·∫øt b·ªã y t·∫ø kh√°c" class="category-icon">Thi·∫øt b·ªã y t·∫ø kh√°c</div>
                                    </div>

                                    <div class="category-main">
                                        <div class="category-detail" id="categoryDetail">
                                            <p>Di chu·ªôt v√†o c√°c nh√≥m s·∫£n ph·∫©m ·ªü tr√™n ƒë·ªÉ xem chi ti·∫øt</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <a href="quan-tri-vien-thongtin.html">Gi·ªõi thi·ªáu</a>
                        <a href="tin-tuc.html">Tin t·ª©c - Ki·∫øn th·ª©c</a>
                    </div>
                </div>
            </div>
        </div>
    </header>
    
    <main>
        <div class="info-container reveal">
            <div class="info-layout">
                <div class="info-left">
                    <img src="hinh-thongtin/congty.png" alt="H√¨nh c√¥ng ty">
                </div>
                <div class="info-right">
                    <img src="hinh-thongtin/thongtin-congty.png" alt="Th√¥ng tin c√¥ng ty">
                </div>
            </div>
        </div>

        <div class="intro-section-container reveal">
            <div class="intro-section-flex">
                <div class="intro-text">
                    <h3>K√≠nh g·ª≠i Qu√Ω ƒê·ªëi t√°c v√† Kh√°ch h√†ng</h3>
                    <p>
                        Tr∆∞·ªõc ti√™n, C√¥ng ty TNHH Thi·∫øt B·ªã Y T·∫ø ƒê·ª©c Ph∆∞∆°ng xin g·ª≠i ƒë·∫øn Qu√Ω v·ªã l·ªùi ch√†o tr√¢n tr·ªçng c√πng nh·ªØng l·ªùi ch√∫c t·ªët ƒë·∫πp nh·∫•t v·ªÅ s·ª©c kh·ªèe v√† b√¨nh an.
                    </p>
                    <p>
                        Ch√∫ng t√¥i r·∫•t vinh d·ª± ƒë∆∞·ª£c gi·ªõi thi·ªáu ƒë√¥i n√©t v·ªÅ h√†nh tr√¨nh h√¨nh th√†nh, ph√°t tri·ªÉn c≈©ng nh∆∞ t·∫ßm nh√¨n v√† s·ª© m·ªánh m√† ƒê·ª©c Ph∆∞∆°ng ƒë√£ v√† ƒëang kh√¥ng ng·ª´ng theo ƒëu·ªïi trong su·ªët h∆°n m·ªôt th·∫≠p k·ª∑ qua.
                    </p>
                </div>
                <div class="intro-image">
                    <img src="hinh-anh/logo-favicon.png" alt="Logo ƒê·ª©c Ph∆∞∆°ng">
                </div>
            </div>
        </div>

        <div class="intro-section-container reveal">
            <div class="intro-section-flex">
                <div class="intro-text">
                    <h3>Gi·ªõi thi·ªáu chung</h3>
                    <p>
                        C√¥ng Ty TNHH Thi·∫øt B·ªã Y T·∫ø ƒê·ª©c Ph∆∞∆°ng, v·ªõi 13 nƒÉm kinh nghi·ªám, l√† m·ªôt trong nh·ªØng ƒë∆°n v·ªã uy t√≠n h√†ng ƒë·∫ßu t·∫°i Vi·ªát Nam trong lƒ©nh v·ª±c cung c·∫•p thi·∫øt b·ªã y t·∫ø, d·ª•ng c·ª• th·ªÉ thao v√† gi∆∞·ªùng b·ªánh nh√¢n ch·∫•t l∆∞·ª£ng cao.
                    </p>
                    <p>
                        V·ªõi n·ªÅn t·∫£ng chuy√™n m√¥n v·ªØng ch·∫Øc v√† s·ª± n·ªó l·ª±c kh√¥ng ng·ª´ng, ƒê·ª©c Ph∆∞∆°ng t·ª± h√†o mang ƒë·∫øn cho kh√°ch h√†ng nh·ªØng s·∫£n ph·∫©m ƒë√°ng tin c·∫≠y, g√≥p ph·∫ßn n√¢ng cao ch·∫•t l∆∞·ª£ng chƒÉm s√≥c s·ª©c kh·ªèe t·∫°i gia ƒë√¨nh, ph√≤ng kh√°m v√† b·ªánh vi·ªán.
                    </p>
                </div>
                <div class="intro-image">
                    <img src="hinh-anh/logo-Tajermy.png" alt="Logo Tajermy">
                </div>
            </div>
        </div>
        
        <div class="section-divider reveal">
            <span>Ng√†nh ngh·ªÅ kinh doanh</span>
        </div>

        <div class="product-card-container reveal">
            <div class="product-card">
                <div class="product-card-text">
                    <h3>Thi·∫øt b·ªã y t·∫ø</h3>
                    <p>Ch√∫ng t√¥i cung c·∫•p ƒëa d·∫°ng c√°c s·∫£n ph·∫©m y t·∫ø hi·ªán ƒë·∫°i, bao g·ªìm:</p>
                    <ul>
                        <li>‚Äì M√°y t·∫°o oxy ch·∫•t l∆∞·ª£ng cao</li>
                        <li>‚Äì M√°y ƒëo huy·∫øt √°p, m√°y ƒëo ƒë∆∞·ªùng huy·∫øt</li>
                        <li>‚Äì M√°y x√¥ng kh√≠ dung v√† thi·∫øt b·ªã h·ªó tr·ª£ ƒëi·ªÅu tr·ªã h√¥ h·∫•p</li>
                    </ul>
                    <p>M·ªói s·∫£n ph·∫©m ƒë·ªÅu ƒë∆∞·ª£c tuy·ªÉn ch·ªçn t·ª´ c√°c nh√† cung c·∫•p uy t√≠n, ƒë·∫°t chu·∫©n an to√†n v√† mang l·∫°i hi·ªáu qu·∫£ ƒëi·ªÅu tr·ªã t·ªëi ∆∞u.</p>
                </div>
                <div class="product-card-image">
                    <img src="hinh-anh/hinh-thietbi.png" alt="Thi·∫øt b·ªã y t·∫ø">
                </div>
            </div>
        </div>

        <div class="product-card-container-reversed reveal">
            <div class="product-card-reversed">
                <div class="product-card-image">
                    <img src="hinh-anh/hinh-dung-cu-the-thao.png" alt="D·ª•ng c·ª• th·ªÉ thao">
                </div>
                <div class="product-card-text">
                    <h3>D·ª•ng c·ª• th·ªÉ thao - chƒÉm s√≥c s·ª©c kh·ªèe</h3>
                    <p>Ch√∫ng t√¥i cung c·∫•p ƒëa d·∫°ng c√°c thi·∫øt b·ªã th·ªÉ thao v√† chƒÉm s√≥c s·ª©c kh·ªèe, bao g·ªìm:</p>
                    <ul>
                        <li>M√°y ch·∫°y b·ªô, xe ƒë·∫°p t·∫≠p, m√°y t·∫≠p ƒëa nƒÉng</li>
                        <li>Thi·∫øt b·ªã th∆∞ gi√£n, massage h·ªó tr·ª£ ph·ª•c h·ªìi th·ªÉ ch·∫•t</li>
                    </ul>
                    <p>Nh·ªØng s·∫£n ph·∫©m n√†y gi√∫p ng∆∞·ªùi d√πng n√¢ng cao s·ª©c kh·ªèe, c·∫£i thi·ªán th·ªÉ l·ª±c v√† duy tr√¨ l·ªëi s·ªëng l√†nh m·∫°nh.</p>
                </div>
            </div>
        </div>

        <div class="product-card-container reveal">
            <div class="product-card">
                <div class="product-card-text">
                    <h3>Gi∆∞·ªùng b·ªánh nh√¢n</h3>
                    <p>S·∫£n ph·∫©m gi∆∞·ªùng y t·∫ø l√† th·∫ø m·∫°nh c·ªßa ƒê·ª©c Ph∆∞∆°ng, g·ªìm:</p>
                    <ul>
                        <li>Gi∆∞·ªùng b·ªánh nh√¢n ƒëi·ªÅu khi·ªÉn ƒëi·ªán</li>
                        <li>Gi∆∞·ªùng b·ªánh nh√¢n c∆° kh√≠</li>
                        <li>Gi∆∞·ªùng ƒëa ch·ª©c nƒÉng d√πng trong gia ƒë√¨nh v√† b·ªánh vi·ªán</li>
                    </ul>
                    <p>T·∫•t c·∫£ ƒë∆∞·ª£c thi·∫øt k·∫ø an to√†n, ch·∫Øc ch·∫Øn, h·ªó tr·ª£ t·ªëi ƒëa cho b·ªánh nh√¢n v√† nh√¢n vi√™n y t·∫ø trong qu√° tr√¨nh chƒÉm s√≥c.</p>
                </div>
                <div class="product-card-image">
                    <img src="hinh-anh/hinh-giuong.png" alt="Gi∆∞·ªùng b·ªánh nh√¢n">
                </div>
            </div>
        </div>

        <div class="section-divider reveal">
            <span>C√°c tri·ªÉn l√£m v√† d·ª± √°n h·ª£p t√°c</span>
        </div>

        <section class="projects-section reveal exhibition-section" id="exhibition-section">
            <div class="container">
                <h2>C√ÅC TRI·ªÇN L√ÉM </h2>
                <div class="projects-form">
                    <div class="projects-slideshow">
                        <div class="project-track" id="exhibitionTrack">
                            <div class="project-slide">
                                <div class="project-item" onclick="openCertModal('hinh-trien-lam/trien-lam1.png', 'Tri·ªÉn l√£m 1')">
                                    <img src="hinh-trien-lam/trien-lam1.png" alt="Tri·ªÉn l√£m 1">
                                </div>
                                <div class="project-item" onclick="openCertModal('hinh-trien-lam/trien-lam2.png', 'Tri·ªÉn l√£m 2')">
                                    <img src="hinh-trien-lam/trien-lam2.png" alt="Tri·ªÉn l√£m 2">
                                </div>
                            </div>
                            <div class="project-slide">
                                <div class="project-item" onclick="openCertModal('hinh-trien-lam/trien-lam3.png', 'Tri·ªÉn l√£m 3')">
                                    <img src="hinh-trien-lam/trien-lam3.png" alt="Tri·ªÉn l√£m 3">
                                </div>
                                <div class="project-item" onclick="openCertModal('hinh-trien-lam/trien-lam4.png', 'Tri·ªÉn l√£m 4')">
                                    <img src="hinh-trien-lam/trien-lam4.png" alt="Tri·ªÉn l√£m 4">
                                </div>
                            </div>
                            <div class="project-slide">
                                <div class="project-item" onclick="openCertModal('hinh-trien-lam/trien-lam5.png', 'Tri·ªÉn l√£m 5')">
                                    <img src="hinh-trien-lam/trien-lam5.png" alt="Tri·ªÉn l√£m 5">
                                </div>
                                <div class="project-item" onclick="openCertModal('hinh-trien-lam/trien-lam6.png', 'Tri·ªÉn l√£m 6')">
                                    <img src="hinh-trien-lam/trien-lam6.png" alt="Tri·ªÉn l√£m 6">
                                </div>
                            </div>
                            <div class="project-slide">
                                <div class="project-item" onclick="openCertModal('hinh-trien-lam/trien-lam7.png', 'Tri·ªÉn l√£m 7')">
                                    <img src="hinh-trien-lam/trien-lam7.png" alt="Tri·ªÉn l√£m 7">
                                </div>
                                <div class="project-item" onclick="openCertModal('hinh-trien-lam/trien-lam8.png', 'Tri·ªÉn l√£m 8')">
                                    <img src="hinh-trien-lam/trien-lam8.png" alt="Tri·ªÉn l√£m 8">
                                </div>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="project-nav-btn project-prev-btn" onclick="prevExhibitionSlide()">‚Äπ</button>
                    <button type="button" class="project-nav-btn project-next-btn" onclick="nextExhibitionSlide()">‚Ä∫</button>
                    <div class="project-indicators">
                        <span class="project-dot active" onclick="currentExhibitionSlide(1)"></span>
                        <span class="project-dot" onclick="currentExhibitionSlide(2)"></span>
                        <span class="project-dot" onclick="currentExhibitionSlide(3)"></span>
                        <span class="project-dot" onclick="currentExhibitionSlide(4)"></span>
                    </div>
                </div>
            </div>
        </section>

        <section class="projects-section reveal exhibition-section" id="projects-section-info">
            <div class="container">
                <h2>D·ª∞ √ÅN </h2>
                <div class="projects-form">
                    <div class="projects-slideshow">
                        <div class="project-track" id="projectTrackInfo">
                            <div class="project-slide">
                                <div class="project-item" onclick="openCertModal('hinh-du-an/du-an1.png', 'D·ª± √°n 1')">
                                    <img src="du-an/du-an1.png" alt="D·ª± √°n 1">
                                </div>
                                <div class="project-item" onclick="openCertModal('hinh-du-an/du-an2.png', 'D·ª± √°n 2')">
                                    <img src="du-an/du-an2.png" alt="D·ª± √°n 2">
                                </div>
                            </div>
                            <div class="project-slide">
                                <div class="project-item" onclick="openCertModal('hinh-du-an/du-an3.png', 'D·ª± √°n 3')">
                                    <img src="du-an/du-an3.png" alt="D·ª± √°n 3">
                                </div>
                                <div class="project-item" onclick="openCertModal('hinh-du-an/du-an4.png', 'D·ª± √°n 4')">
                                    <img src="du-an/du-an4.png" alt="D·ª± √°n 4">
                                </div>
                            </div>
                            <div class="project-slide">
                                <div class="project-item" onclick="openCertModal('hinh-du-an/du-an5.png', 'D·ª± √°n 5')">
                                    <img src="du-an/du-an5.png" alt="D·ª± √°n 5">
                                </div>
                                <div class="project-item" onclick="openCertModal('hinh-du-an/du-an6.png', 'D·ª± √°n 6')">
                                    <img src="du-an/du-an6.png" alt="D·ª± √°n 6">
                                </div>
                            </div>
                            <div class="project-slide">
                                <div class="project-item" onclick="openCertModal('hinh-du-an/du-an7.png', 'D·ª± √°n 7')">
                                    <img src="du-an/du-an7.png" alt="D·ª± √°n 7">
                                </div>
                                <div class="project-item" onclick="openCertModal('hinh-du-an/du-an8.png', 'D·ª± √°n 8')">
                                    <img src="du-an/du-an8.png" alt="D·ª± √°n 8">
                                </div>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="project-nav-btn project-prev-btn" onclick="prevProjectInfoSlide()">‚Äπ</button>
                    <button type="button" class="project-nav-btn project-next-btn" onclick="nextProjectInfoSlide()">‚Ä∫</button>
                    <div class="project-indicators">
                        <span class="project-dot active" onclick="currentProjectInfoSlide(1)"></span>
                        <span class="project-dot" onclick="currentProjectInfoSlide(2)"></span>
                        <span class="project-dot" onclick="currentProjectInfoSlide(3)"></span>
                        <span class="project-dot" onclick="currentProjectInfoSlide(4)"></span>
                    </div>
                </div>
            </div>
        </section>

        <div class="section-divider reveal">
            <span>X∆∞∆°ng S·∫£n Xu·∫•t </span>
        </div>

        <section class="projects-section reveal exhibition-section" id="factory-section">
            <div class="container">
                <h2>X∆Ø·ªûNG S·∫¢N XU·∫§T</h2>
                <div class="projects-form">
                    <div class="projects-slideshow">
                        <div class="project-track" id="factoryTrack">
                            <div class="project-slide">
                                <div class="project-item" onclick="openCertModal('hinh-xuong/hinh-xuong1.png', 'X∆∞·ªüng 1')">
                                    <img src="hinh-xuong/hinh-xuong1.png" alt="X∆∞·ªüng 1">
                                </div>
                                <div class="project-item" onclick="openCertModal('hinh-xuong/hinh-xuong2.png', 'X∆∞·ªüng 2')">
                                    <img src="hinh-xuong/hinh-xuong2.png" alt="X∆∞·ªüng 2">
                                </div>
                            </div>
                            <div class="project-slide">
                                <div class="project-item" onclick="openCertModal('hinh-xuong/hinh-xuong3.png', 'X∆∞·ªüng 3')">
                                    <img src="hinh-xuong/hinh-xuong3.png" alt="X∆∞·ªüng 3">
                                </div>
                                <div class="project-item" onclick="openCertModal('hinh-xuong/hinh-xuong4.png', 'X∆∞·ªüng 4')">
                                    <img src="hinh-xuong/hinh-xuong4.png" alt="X∆∞·ªüng 4">
                                </div>
                            </div>
                            <div class="project-slide">
                                <div class="project-item" onclick="openCertModal('hinh-xuong/hinh-xuong5.png', 'X∆∞·ªüng 5')">
                                    <img src="hinh-xuong/hinh-xuong5.png" alt="X∆∞·ªüng 5">
                                </div>
                                <div class="project-item" onclick="openCertModal('hinh-xuong/hinh-xuong6.png', 'X∆∞·ªüng 6')">
                                    <img src="hinh-xuong/hinh-xuong6.png" alt="X∆∞·ªüng 6">
                                </div>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="project-nav-btn project-prev-btn" onclick="prevFactorySlide()">‚Äπ</button>
                    <button type="button" class="project-nav-btn project-next-btn" onclick="nextFactorySlide()">‚Ä∫</button>
                    <div class="project-indicators">
                        <span class="project-dot active" onclick="currentFactorySlide(1)"></span>
                        <span class="project-dot" onclick="currentFactorySlide(2)"></span>
                        <span class="project-dot" onclick="currentFactorySlide(3)"></span>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeLoginForm()">&times;</span>
            <div class="login-container">
                <div class="login-header">
                    <div class="service-icons">
                        <div class="fpt-icon">TaJerMy</div>
                        <div class="arrow">‚Üí</div>
                        <div class="shop-icon">üõçÔ∏è</div>
                    </div>
                    <h2>T√†i kho·∫£n s·ª≠ d·ª•ng d·ªãch v·ª• <span class="fpt-logo">TaJerMy</span></h2>
                </div>
                
                <div class="login-form">
                    <!-- Step 1: Phone -->
                    <div id="loginStep1">
                        <label>T√™n ƒëƒÉng nh·∫≠p / S·ªë ƒëi·ªán tho·∫°i <span class="required">*</span></label>
                        <input type="text" id="loginInput" placeholder="Nh·∫≠p t√™n ƒëƒÉng nh·∫≠p ho·∫∑c s·ªë ƒëi·ªán tho·∫°i" class="login-input">
                        <button class="continue-btn" onclick="handleLoginStep1()">Ti·∫øp t·ª•c</button>
                    </div>

                    <!-- Step 2: Password -->
                    <div id="loginStep2" style="display: none;">
                        <div class="login-header-step2"><button class="back-btn" onclick="backToStep1()">‚Üê</button> Nh·∫≠p m·∫≠t kh·∫©u</div>
                        <label>M·∫≠t kh·∫©u <span class="required">*</span></label>
                        <input type="password" id="loginPassword" placeholder="Nh·∫≠p m·∫≠t kh·∫©u" class="login-input">
                        <button class="continue-btn" onclick="handleLoginStep2()">ƒêƒÉng nh·∫≠p</button>
                    </div>

                    <!-- Register Step -->
                    <div id="registerStep" style="display: none;">
                        <span onclick="backToLogin()" style="position: absolute; top: 10px; left: 20px; font-size: 30px; font-weight: bold; color: #aaa; cursor: pointer; z-index: 10;">‚Üê</span>
                        <div style="text-align: center; font-weight: bold; font-size: 18px; margin-bottom: 15px; margin-top: -10px;">ƒêƒÉng k√Ω t√†i kho·∫£n</div>
                        
                        <label>T√™n ƒëƒÉng nh·∫≠p <span class="required">*</span></label>
                        <input type="text" id="regUsername" class="login-input" placeholder="Nh·∫≠p t√™n ƒëƒÉng nh·∫≠p" style="margin-bottom: 5px;">
                        
                        <label>S·ªë ƒëi·ªán tho·∫°i <span class="required">*</span></label>
                        <input type="text" id="regPhone" class="login-input" placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i" style="margin-bottom: 5px;">
                        
                        <label>Email <span class="required">*</span></label>
                        <input type="email" id="regGmail" class="login-input" placeholder="Nh·∫≠p email" style="margin-bottom: 5px;">
                        
                        <label>M·∫≠t kh·∫©u <span class="required">*</span></label>
                        <input type="password" id="regPass" class="login-input" placeholder="Nh·∫≠p m·∫≠t kh·∫©u" style="margin-bottom: 5px;">
                        
                        <label>M√£ x√°c nh·∫≠n <span class="required">*</span></label>
                        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                            <input type="text" id="regCode" class="login-input" placeholder="Nh·∫≠p m√£ x√°c nh·∫≠n" style="flex: 1; margin-bottom: 0;">
                            <button type="button" class="continue-btn" onclick="sendVerificationCode()" style="width: auto; margin: 0; padding: 0 15px;">Nh·∫≠n m√£</button>
                        </div>
                        
                        <button class="continue-btn" onclick="handleRegister()">ƒêƒÉng k√Ω</button>
                        <div id="registerMessage" style="text-align: center; margin-top: 2px; font-weight: bold;"></div>
                    </div>

                    <p class="terms-text">
                        B·∫±ng c√°ch ti·∫øp t·ª•c, b·∫°n ƒë·ªìng √Ω v·ªõi 
                        <a href="#" class="link">ƒêi·ªÅu kho·∫£n</a> v√† 
                        <a href="#" class="link">Ch√≠nh s√°ch</a> b·∫£o m·∫≠t c·ªßa TaJerMy
                    </p>
                    
                    <div class="divider">
                        <span>Ho·∫∑c ƒëƒÉng nh·∫≠p b·∫±ng</span>
                    </div>      
                    <div class="social-login">
                        <button class="social-btn apple-btn" onclick="showRegisterForm()">ƒêƒÉng k√Ω</button>
                        <button class="social-btn google-btn">
                            <img src="hinh-anh/google-logo.png" alt="Google" class="google-icon">
                        </button>
                        <button class="social-btn facebook-btn">
                            <img src="hinh-anh/fb-logo.png" alt="Facebook" class="facebook-icon">
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        // Check session on load
        document.addEventListener('DOMContentLoaded', function() {
            checkLoginStatus();
        });

        let isLoggedIn = false;
        let currentEditingImage = null; // Bi·∫øn l∆∞u tr·ªØ ·∫£nh ƒëang ƒë∆∞·ª£c s·ª≠a
        let currentEditingText = null; // Bi·∫øn l∆∞u tr·ªØ vƒÉn b·∫£n ƒëang ƒë∆∞·ª£c s·ª≠a

        function checkLoginStatus() {
            fetch('/check_session.php', { credentials: 'include' })
                .then(response => response.json())
                .then(data => {
                    const accountDropdown = document.querySelector('.account-dropdown');
                    if (data.logged_in) {
                        // L∆∞u position v√†o localStorage
                        if (data.position) {
                            saveUserPosition(data.position);
                        }
                        
                        // Chu·∫©n ho√° position v·ªÅ kh√¥ng d·∫•u ƒë·ªÉ so s√°nh
                        const pos = (data.position || '').toString().toLowerCase();

                        // Ki·ªÉm tra quy·ªÅn Qu·∫£n tr·ªã vi√™n
                        if (pos !== 'quan-tri-vien' && pos !== 'admin') {
                            // N·∫øu kh√¥ng ph·∫£i admin -> xo√° quy·ªÅn v√† ƒë∆∞a v·ªÅ trang kh√°ch
                            if (typeof clearUserPosition === 'function') {
                                clearUserPosition();
                            }
                            window.location.href = 'index.html';
                            return;
                        }

                        isLoggedIn = true;
                        if (accountDropdown) accountDropdown.classList.add('logged-in');
                        
                        const usernameDisplay = document.getElementById('usernameDisplay');
                        if (usernameDisplay) {
                            usernameDisplay.innerText = data.username;
                            usernameDisplay.style.display = 'block';
                        }
                        // Hide login modal if open
                        closeLoginForm();
                        
                        // Load d·ªØ li·ªáu ƒë√£ l∆∞u tr∆∞·ªõc ƒë√≥ & G√°n ID
                        initializeContentSystem();
                        // K√≠ch ho·∫°t giao di·ªán ch·ªânh s·ª≠a
                        initAdminInterface();
                    } else {
                        // Ch∆∞a ƒëƒÉng nh·∫≠p -> ƒë∆∞a v·ªÅ trang ch√≠nh
                        if (typeof clearUserPosition === 'function') {
                            clearUserPosition();
                        }
                        window.location.href = 'index.html';
                        isLoggedIn = false;
                    }
                })
                .catch(err => {
                    console.error('Session check failed', err);
                    // Fallback cho demo n·∫øu kh√¥ng c√≥ backend
                    // initAdminInterface(); 
                });
        }

        // H·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung: G√°n ID v√† Load d·ªØ li·ªáu
        function initializeContentSystem() {
            // 1. G√°n ID duy nh·∫•t cho c√°c ph·∫ßn t·ª≠ c√≥ th·ªÉ s·ª≠a
            const images = document.querySelectorAll('header img, main img, footer img');
            images.forEach((img, index) => {
                if (!img.hasAttribute('data-uid')) {
                    img.setAttribute('data-uid', 'img-' + index);
                }
            });

            const textTags = ['h1', 'h2', 'h3', 'h4', 'h5', 'p', 'span', 'li', 'a', 'td', 'th'];
            let textIndex = 0;
            textTags.forEach(tagName => {
                document.querySelectorAll(`header ${tagName}, main ${tagName}, footer ${tagName}`).forEach(el => {
                    if (!el.hasAttribute('data-uid') && el.innerText.trim().length > 0 && !el.closest('.admin-edit-btn')) {
                        el.setAttribute('data-uid', 'txt-' + textIndex++);
                    }
                });
            });

            // Load d·ªØ li·ªáu t·ª´ localStorage
            const savedData = JSON.parse(localStorage.getItem('siteContentThongTin') || '{}');
            for (const [uid, value] of Object.entries(savedData)) {
                const element = document.querySelector(`[data-uid="${uid}"]`);
                if (element) {
                    if (uid.startsWith('img-')) {
                        element.src = value;
                    } else if (uid.startsWith('contact-')) {
                        element.href = value;
                    } else {
                        // Khi load, ch∆∞a c√≥ n√∫t s·ª≠a, n√™n c√≥ th·ªÉ set innerText an to√†n
                        element.innerText = value;
                    }
                }
            }
        }

        // H√†m kh·ªüi t·∫°o giao di·ªán Admin (Th√™m n√∫t s·ª≠a)
        function initAdminInterface() {
            console.log("Admin Interface Initialized");
            
            // 1. Th√™m n√∫t s·ª≠a cho H√åNH ·∫¢NH
            const images = document.querySelectorAll('img');
            images.forEach(img => {
                // B·ªè qua c√°c icon nh·ªè ho·∫∑c ·∫£nh trong n√∫t
                if (img.width < 50 || img.height < 50 || img.closest('.admin-edit-btn')) return;
                
                // B·ªè qua c√°c icon li√™n k·∫øt b√™n ph·∫£i (phone, zalo, youtube, facebook)
                if (img.closest('.phone-contact') || img.closest('.zalo-contact') || 
                    img.closest('.youtube-contact') || img.closest('.facebook-contact')) {
                    return;
                }

                const btn = document.createElement('button');
                btn.innerHTML = '‚úèÔ∏è Ch·ªânh s·ª≠a';
                btn.className = 'admin-edit-btn admin-edit-btn-img';
                btn.onclick = (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    openImageEditModal(img); // M·ªü modal ch·ªânh s·ª≠a
                };

                // C·∫ßn parent c√≥ position relative ƒë·ªÉ ƒë·ªãnh v·ªã n√∫t
                const parent = img.parentElement;
                if (parent) {
                    const computedStyle = window.getComputedStyle(parent);
                    if (computedStyle.position === 'static') {
                        parent.style.position = 'relative';
                    }
                    parent.appendChild(btn);
                }
            });

            // 2. Th√™m n√∫t s·ª≠a cho VƒÇN B·∫¢N
            // Danh s√°ch c√°c th·∫ª ch·ª©a vƒÉn b·∫£n c·∫ßn s·ª≠a
            const textTags = ['h1', 'h2', 'h3', 'h4', 'h5', 'p', 'span', 'li', 'a', 'td', 'th'];
            
            textTags.forEach(tagName => {
                const elements = document.querySelectorAll(tagName);
                elements.forEach(el => {
                    // Ki·ªÉm tra xem element c√≥ ch·ª©a text tr·ª±c ti·∫øp kh√¥ng (tr√°nh th√™m v√†o container r·ªóng)
                    let hasDirectText = false;
                    for (let i = 0; i < el.childNodes.length; i++) {
                        if (el.childNodes[i].nodeType === Node.TEXT_NODE && el.childNodes[i].textContent.trim().length > 0) {
                            hasDirectText = true;
                            break;
                        }
                    }

                    // ƒêi·ªÅu ki·ªán l·ªçc: C√≥ text, kh√¥ng ph·∫£i n√∫t admin, kh√¥ng n·∫±m trong n√∫t admin
                    if (hasDirectText && !el.classList.contains('admin-edit-btn') && !el.closest('.admin-edit-btn')) {
                        const btn = document.createElement('button');
                        btn.innerHTML = '‚úèÔ∏è';
                        btn.className = 'admin-edit-btn';
                        btn.title = 'Ch·ªânh s·ª≠a vƒÉn b·∫£n';
                        btn.onclick = (e) => {
                            e.preventDefault();
                            e.stopPropagation();
                            openTextEditModal(el); // M·ªü modal s·ª≠a vƒÉn b·∫£n
                        };
                        el.appendChild(btn);
                    }
                });
            });

        }

        function handleAccountClick(event) {
            event.stopPropagation(); // NgƒÉn event bubble l√™n c√°c ph·∫ßn t·ª≠ cha
            
            const accountMenu = document.getElementById('accountMenu');
            
            // Ki·ªÉm tra tr·∫°ng th√°i ƒëƒÉng nh·∫≠p
            if (!isLoggedIn) {
                // Ch∆∞a ƒëƒÉng nh·∫≠p ‚Üí hi·ªÉn th·ªã form ƒëƒÉng nh·∫≠p
                toggleLoginForm();
            } else {
                // ƒê√£ ƒëƒÉng nh·∫≠p ‚Üí toggle hi·ªÉn th·ªã menu
                if (accountMenu.style.display === 'block') {
                    accountMenu.style.display = 'none';
                } else {
                    accountMenu.style.display = 'block';
                }
            }
        }

        // ƒê√≥ng menu khi click ra ngo√†i
        document.addEventListener('click', function(event) {
            const accountDropdown = document.querySelector('.account-dropdown');
            const accountMenu = document.getElementById('accountMenu');
            
            if (accountDropdown && !accountDropdown.contains(event.target)) {
                accountMenu.style.display = 'none';
            }
        });

        function handleLoginStep1() {
            const inputVal = document.getElementById('loginInput').value;
            if (!inputVal) {
                alert('Vui l√≤ng nh·∫≠p t√™n ƒëƒÉng nh·∫≠p ho·∫∑c s·ªë ƒëi·ªán tho·∫°i!');
                return;
            }
            // Switch to step 2
            document.getElementById('loginStep1').style.display = 'none';
            document.getElementById('loginStep2').style.display = 'block';
        }

        function backToStep1() {
            document.getElementById('loginStep1').style.display = 'block';
            document.getElementById('loginStep2').style.display = 'none';
        }

        function handleLoginStep2() {
            const inputVal = document.getElementById('loginInput').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!password) {
                alert('Vui l√≤ng nh·∫≠p m·∫≠t kh·∫©u!');
                return;
            }

            fetch('login.php', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ username: inputVal, password: password })
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    // L∆∞u position v√†o localStorage
                    if (data.position) {
                        saveUserPosition(data.position);
                    }
                    
                    // Chuy·ªÉn h∆∞·ªõng tr·ª±c ti·∫øp kh√¥ng c·∫ßn th√¥ng b√°o
                    window.location.reload(); // Reload ƒë·ªÉ check l·∫°i quy·ªÅn
                } else {
                    alert(data.message);
                }
            })
            .catch(error => console.error('Error:', error));
        }

        function handleLogout() {
            // X√≥a position kh·ªèi localStorage
            clearUserPosition();
            
            fetch('logout.php')
                .then(() => {
                    window.location.href = 'thong-tin.html'; // Logout xong v·ªÅ trang th√¥ng tin th∆∞·ªùng
                });
        }

        function showRegisterForm() {
            // ·∫®n c√°c ph·∫ßn c·ªßa form ƒëƒÉng nh·∫≠p
            document.getElementById('loginStep1').style.display = 'none';
            document.getElementById('loginStep2').style.display = 'none';
            document.querySelector('.terms-text').style.display = 'none';
            document.querySelector('.divider').style.display = 'none';
            document.querySelector('.social-login').style.display = 'none';
            
            // Hi·ªán form ƒëƒÉng k√Ω
            document.getElementById('registerStep').style.display = 'block';
            
            // Reset form ƒëƒÉng k√Ω
            document.getElementById('registerMessage').innerText = '';
            document.getElementById('regUsername').value = '';
            document.getElementById('regPhone').value = '';
            document.getElementById('regGmail').value = '';
            document.getElementById('regPass').value = '';
            if(document.getElementById('regCode')) document.getElementById('regCode').value = '';
        }

        function backToLogin() {
            document.getElementById('registerStep').style.display = 'none';
            document.getElementById('loginStep1').style.display = 'block';
            document.querySelector('.terms-text').style.display = 'block';
            document.querySelector('.divider').style.display = 'block';
            document.querySelector('.social-login').style.display = 'flex';
        }

        function sendVerificationCode() {
            const gmail = document.getElementById('regGmail').value;
            if (!gmail) {
                alert('Vui l√≤ng nh·∫≠p email ƒë·ªÉ nh·∫≠n m√£!');
                return;
            }
            
            const formData = new FormData();
            formData.append('send', 'true');
            formData.append('gmail', gmail);

            fetch('/xacnhangamil.php', {
                method: 'POST',
                body: formData
            })
            .then(response => response.text())
            .then(data => {
                alert(data);
            })
            .catch(error => {
                console.error('Error:', error);
                alert('C√≥ l·ªói x·∫£y ra khi g·ª≠i m√£.');
            });
        }

        function handleRegister() {
            const user = document.getElementById('regUsername').value;
            const phone = document.getElementById('regPhone').value;
            const gmail = document.getElementById('regGmail').value;
            const pass = document.getElementById('regPass').value;
            const code = document.getElementById('regCode').value;
            const msgDiv = document.getElementById('registerMessage');

            if (!user || !phone || !gmail || !pass || !code) {
                msgDiv.style.color = 'red';
                msgDiv.innerText = 'Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin v√† m√£ x√°c nh·∫≠n!';
                return;
            }

            // Verify code first
            const formData = new FormData();
            formData.append('code', code);

            fetch('/check_code.php', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    // Code correct, proceed to register
                    fetch('/register.php', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ username: user, phone: phone, gmail: gmail, password: pass })
                    })
                    .then(response => response.json())
                    .then(regData => {
                        if (regData.status === 'success') {
                            msgDiv.style.color = '#4CAF50';
                            msgDiv.innerText = 'ƒêƒÉng k√Ω th√†nh c√¥ng!';
                        } else {
                            msgDiv.style.color = 'red';
                            msgDiv.innerText = regData.message;
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        msgDiv.style.color = 'red';
                        msgDiv.innerText = 'C√≥ l·ªói x·∫£y ra, vui l√≤ng th·ª≠ l·∫°i.';
                    });
                } else {
                    msgDiv.style.color = 'red';
                    msgDiv.innerText = 'Sai m√£ x√°c nh·∫≠n';
                }
            })
            .catch(error => {
                console.error('Error:', error);
                msgDiv.style.color = 'red';
                msgDiv.innerText = 'L·ªói ki·ªÉm tra m√£ x√°c nh·∫≠n.';
            });
        }

        function toggleRegisterPassword(btn) {
            const passwordInput = document.getElementById('regPass');
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                btn.textContent = 'üôà'; // Icon ·∫©n
            } else {
                passwordInput.type = 'password';
                btn.textContent = 'üëÅÔ∏è'; // Icon hi·ªán
            }
        }

        function toggleLoginForm() {
            document.getElementById('loginModal').style.display = 'block';
            // ƒê·∫£m b·∫£o quay v·ªÅ m√†n h√¨nh ƒëƒÉng nh·∫≠p m·∫∑c ƒë·ªãnh khi m·ªü modal
            if (typeof backToLogin === 'function') backToLogin();
            if (typeof backToStep1 === 'function') backToStep1(); 
            if(document.getElementById('loginInput')) document.getElementById('loginInput').value = '';
            if(document.getElementById('loginPassword')) document.getElementById('loginPassword').value = '';
        }
        
        function closeLoginForm() {
            document.getElementById('loginModal').style.display = 'none';
        }
        
        window.onclick = function(event) {
            var modal = document.getElementById('loginModal');
            var certModal = document.getElementById('certModal');
            var imageEditModal = document.getElementById('imageEditModal');
            var textEditModal = document.getElementById('textEditModal');
            var linkEditModal = document.getElementById('linkEditModal');
            if (event.target == modal) {
                modal.style.display = 'none';
            }
            if (event.target == certModal) {
                certModal.style.display = 'none';
            }
            if (event.target == imageEditModal) {
                closeImageEditModal();
            }
            if (event.target == textEditModal) {
                closeTextEditModal();
            }
            if (event.target == linkEditModal) {
                closeLinkEditModal();
            }
        }
        
        // ================== Slideshow logic gi·ªëng thong-tin.html ==================
        // Exhibition slideshow logic
        let currentExhibitionIndex = 0;
        let exhibitionDirection = 1;
        let exhibitionInterval;
        const exhibitionTrack = document.getElementById('exhibitionTrack');
        const exhibitionDots = document.querySelectorAll('#exhibition-section .project-dot');
        const maxExhibitionIndex = 3; // 4 slides (0-3)
        
        function updateExhibitionSlide() {
            if (!exhibitionTrack) return;
            const translateX = -(currentExhibitionIndex * 25); // 25% per slide
            exhibitionTrack.style.transform = `translateX(${translateX}%)`;
            updateExhibitionButtons();
            updateExhibitionDots();
        }
        
        function updateExhibitionDots() {
            exhibitionDots.forEach((dot, index) => {
                dot.classList.toggle('active', index === currentExhibitionIndex);
            });
        }
        
        function updateExhibitionButtons() {
            const prevBtn = document.querySelector('#exhibition-section .project-prev-btn');
            const nextBtn = document.querySelector('#exhibition-section .project-next-btn');
            if (!prevBtn || !nextBtn) return;
            
            if (currentExhibitionIndex === 0 && exhibitionDirection === 1) {
                prevBtn.style.opacity = '0';
                prevBtn.style.pointerEvents = 'none';
            } else {
                prevBtn.style.opacity = '1';
                prevBtn.style.pointerEvents = 'auto';
            }
            
            if (currentExhibitionIndex === maxExhibitionIndex && exhibitionDirection === -1) {
                nextBtn.style.opacity = '0';
                nextBtn.style.pointerEvents = 'none';
            } else {
                nextBtn.style.opacity = '1';
                nextBtn.style.pointerEvents = 'auto';
            }
        }
        
        function autoExhibitionSlide() {
            if (currentExhibitionIndex >= maxExhibitionIndex) {
                exhibitionDirection = -1;
            } else if (currentExhibitionIndex <= 0) {
                exhibitionDirection = 1;
            }
            currentExhibitionIndex += exhibitionDirection;
            updateExhibitionSlide();
        }
        
        function nextExhibitionSlide() {
            clearInterval(exhibitionInterval);
            if (currentExhibitionIndex < maxExhibitionIndex) {
                currentExhibitionIndex++;
                exhibitionDirection = 1;
            } else {
                exhibitionDirection = -1;
                currentExhibitionIndex--;
            }
            updateExhibitionSlide();
            exhibitionInterval = setInterval(autoExhibitionSlide, 3000);
        }
        function prevExhibitionSlide() {
            clearInterval(exhibitionInterval);
            if (currentExhibitionIndex > 0) {
                currentExhibitionIndex--;
                exhibitionDirection = -1;
            } else {
                exhibitionDirection = 1;
                currentExhibitionIndex++;
            }
            updateExhibitionSlide();
            exhibitionInterval = setInterval(autoExhibitionSlide, 3000);
        }
        function currentExhibitionSlide(n) {
            clearInterval(exhibitionInterval);
            currentExhibitionIndex = n - 1;
            exhibitionDirection = 1;
            updateExhibitionSlide();
            exhibitionInterval = setInterval(autoExhibitionSlide, 3000);
        }
        
        updateExhibitionSlide();
        exhibitionInterval = setInterval(autoExhibitionSlide, 3000);

        // Project Info slideshow logic
        let currentProjectInfoIndex = 0;
        let projectInfoDirection = 1;
        let projectInfoInterval;
        const projectInfoTrack = document.getElementById('projectTrackInfo');
        const projectInfoDots = document.querySelectorAll('#projects-section-info .project-dot');
        const maxProjectInfoIndex = 3; // 4 slides
        
        function updateProjectInfoSlide() {
            if (!projectInfoTrack) return;
            const translateX = -(currentProjectInfoIndex * 25);
            projectInfoTrack.style.transform = `translateX(${translateX}%)`;
            updateProjectInfoButtons();
            updateProjectInfoDots();
        }
        
        function updateProjectInfoDots() {
            projectInfoDots.forEach((dot, index) => {
                dot.classList.toggle('active', index === currentProjectInfoIndex);
            });
        }
        
        function updateProjectInfoButtons() {
            const prevBtn = document.querySelector('#projects-section-info .project-prev-btn');
            const nextBtn = document.querySelector('#projects-section-info .project-next-btn');
            if (!prevBtn || !nextBtn) return;
            
            if (currentProjectInfoIndex === 0 && projectInfoDirection === 1) {
                prevBtn.style.opacity = '0';
                prevBtn.style.pointerEvents = 'none';
            } else {
                prevBtn.style.opacity = '1';
                prevBtn.style.pointerEvents = 'auto';
            }
            
            if (currentProjectInfoIndex === maxProjectInfoIndex && projectInfoDirection === -1) {
                nextBtn.style.opacity = '0';
                nextBtn.style.pointerEvents = 'none';
            } else {
                nextBtn.style.opacity = '1';
                nextBtn.style.pointerEvents = 'auto';
            }
        }
        
        function autoProjectInfoSlide() {
            if (currentProjectInfoIndex >= maxProjectInfoIndex) {
                projectInfoDirection = -1;
            } else if (currentProjectInfoIndex <= 0) {
                projectInfoDirection = 1;
            }
            currentProjectInfoIndex += projectInfoDirection;
            updateProjectInfoSlide();
        }
        
        function nextProjectInfoSlide() {
            clearInterval(projectInfoInterval);
            if (currentProjectInfoIndex < maxProjectInfoIndex) {
                currentProjectInfoIndex++;
                projectInfoDirection = 1;
            } else {
                projectInfoDirection = -1;
                currentProjectInfoIndex--;
            }
            updateProjectInfoSlide();
            projectInfoInterval = setInterval(autoProjectInfoSlide, 3000);
        }
        function prevProjectInfoSlide() {
            clearInterval(projectInfoInterval);
            if (currentProjectInfoIndex > 0) {
                currentProjectInfoIndex--;
                projectInfoDirection = -1;
            } else {
                projectInfoDirection = 1;
                currentProjectInfoIndex++;
            }
            updateProjectInfoSlide();
            projectInfoInterval = setInterval(autoProjectInfoSlide, 3000);
        }
        function currentProjectInfoSlide(n) {
            clearInterval(projectInfoInterval);
            currentProjectInfoIndex = n - 1;
            projectInfoDirection = 1;
            updateProjectInfoSlide();
            projectInfoInterval = setInterval(autoProjectInfoSlide, 3000);
        }
        
        updateProjectInfoSlide();
        projectInfoInterval = setInterval(autoProjectInfoSlide, 3000);

        // Factory slideshow logic
        let currentFactoryIndex = 0;
        let factoryDirection = 1;
        let factoryInterval;
        const factoryTrack = document.getElementById('factoryTrack');
        const factoryDots = document.querySelectorAll('#factory-section .project-dot');
        const maxFactoryIndex = 2; // 3 slides
        
        function updateFactorySlide() {
            if (!factoryTrack) return;
            const translateX = -(currentFactoryIndex * 33.333);
            factoryTrack.style.transform = `translateX(${translateX}%)`;
            updateFactoryButtons();
            updateFactoryDots();
        }
        
        function updateFactoryDots() {
            factoryDots.forEach((dot, index) => {
                dot.classList.toggle('active', index === currentFactoryIndex);
            });
        }
        
        function updateFactoryButtons() {
            const prevBtn = document.querySelector('#factory-section .project-prev-btn');
            const nextBtn = document.querySelector('#factory-section .project-next-btn');
            if (!prevBtn || !nextBtn) return;
            
            if (currentFactoryIndex === 0 && factoryDirection === 1) {
                prevBtn.style.opacity = '0';
                prevBtn.style.pointerEvents = 'none';
            } else {
                prevBtn.style.opacity = '1';
                prevBtn.style.pointerEvents = 'auto';
            }
            
            if (currentFactoryIndex === maxFactoryIndex && factoryDirection === -1) {
                nextBtn.style.opacity = '0';
                nextBtn.style.pointerEvents = 'none';
            } else {
                nextBtn.style.opacity = '1';
                nextBtn.style.pointerEvents = 'auto';
            }
        }
        
        function autoFactorySlide() {
            if (currentFactoryIndex >= maxFactoryIndex) {
                factoryDirection = -1;
            } else if (currentFactoryIndex <= 0) {
                factoryDirection = 1;
            }
            currentFactoryIndex += factoryDirection;
            updateFactorySlide();
        }
        
        function nextFactorySlide() {
            clearInterval(factoryInterval);
            if (currentFactoryIndex < maxFactoryIndex) {
                currentFactoryIndex++;
                factoryDirection = 1;
            } else {
                factoryDirection = -1;
                currentFactoryIndex--;
            }
            updateFactorySlide();
            factoryInterval = setInterval(autoFactorySlide, 3000);
        }
        function prevFactorySlide() {
            clearInterval(factoryInterval);
            if (currentFactoryIndex > 0) {
                currentFactoryIndex--;
                factoryDirection = -1;
            } else {
                factoryDirection = 1;
                currentFactoryIndex++;
            }
            updateFactorySlide();
            factoryInterval = setInterval(autoFactorySlide, 3000);
        }
        function currentFactorySlide(n) {
            clearInterval(factoryInterval);
            currentFactoryIndex = n - 1;
            factoryDirection = 1;
            updateFactorySlide();
            factoryInterval = setInterval(autoFactorySlide, 3000);
        }
        
        updateFactorySlide();
        factoryInterval = setInterval(autoFactorySlide, 3000);

        // Category data for dropdown hover
        // Category data for dropdown hover
        const categoryData = {
            'Gi∆∞·ªùng': ['Gi∆∞·ªùng b·ªánh c∆° b·∫£n', 'Gi∆∞·ªùng chuy√™n d·ª•ng (ICU, s·∫£n khoa)', 'Gi∆∞·ªùng ƒëi·ªÅu ch·ªânh ƒë·ªô cao/ t∆∞ th·∫ø (gi∆∞·ªùng ƒëi·ªán)', 'Gi∆∞·ªùng chƒÉm s√≥c t·∫°i nh√†'],
            'Xe lƒÉn': ['Xe lƒÉn tay (ng∆∞·ªùi d√πng t·ª± ƒë·∫©y)', 'Xe lƒÉn ƒë·∫©y sau (ng∆∞·ªùi chƒÉm s√≥c ƒë·∫©y)', 'Xe lƒÉn ƒëi·ªán', 'Xe lƒÉn th·ªÉ thao', 'Xe lƒÉn g·∫•p g·ªçn/ di chuy·ªÉn', 'Xe lƒÉn l√™n xu·ªëng c·∫ßu thang'],
            'Xe Scooter ƒëi·ªán': ['Lo·∫°i di chuy·ªÉn trong nh√†/ ƒë∆∞·ªùng b·∫±ng ph·∫≥ng', 'Lo·∫°i ƒë·ªãa h√¨nh (b√°nh l·ªõn, ƒëi ƒë∆∞·ªùng d√†i)', 'Lo·∫°i g·∫•p g·ªçn/ th√°o r·ªùi'],
            'BƒÉng ca': ['BƒÉng ca c·∫•p c·ª©u (c·ªë ƒë·ªãnh)', 'BƒÉng ca ƒë·∫©y (c√≥ b√°nh xe)', 'BƒÉng ca g·∫•p (v·∫≠n chuy·ªÉn)', 'BƒÉng ca chuy√™n d·ª•ng (ch·ªëng s·ªëc, ch·ª•p X-Quang)', 'ƒê·ªám v·∫≠n chuy·ªÉn'],
            'T·ªß': ['T·ªß ƒë·ª±ng thu·ªëc', 'T·ªß ƒë·ª±ng h·ªì s∆° b·ªánh √°n', 'T·ªß tr∆∞ng b√†y/ l∆∞u tr·ªØ d·ª•ng c·ª•', 'T·ªß ƒë·∫ßu gi∆∞·ªùng b·ªánh'],
            'M√°y t·∫°o oxy': ['M√°y t·∫°o oxy t·∫°i nh√† (lo·∫°i l·ªõn)', 'M√°y t·∫°o oxy x√°ch tay/ di ƒë·ªông', 'M√°y t·∫°o oxy d√≤ng cao (cho tr·ªã li·ªáu ƒë·∫∑c bi·ªát)'],
            'M√°y ƒëo': ['M√°y ƒëo huy·∫øt √°p', 'M√°y ƒëo ƒë∆∞·ªùng huy·∫øt', 'M√°y ƒëo n·ªìng ƒë·ªô oxy trong m√°u (SpO2)', 'M√°y ƒëo th√¢n nhi·ªát', 'M√°y ƒëo tim (ECG di ƒë·ªông)', 'C√¢n s·ª©c kh·ªèe (c∆°/ ƒëi·ªán t·ª≠)'],
            'M√°y x√¥ng': ['M√°y x√¥ng kh√≠ dung ki·ªÉu n√©n', 'M√°y x√¥ng si√™u √¢m', 'M√°y x√¥ng m√†ng (mesh)'],
            'M√°y h√∫t d·ªãch': ['M√°y h√∫t d·ªãch ƒë·ªÉ b√†n/ c·ªë ƒë·ªãnh', 'M√°y h√∫t d·ªãch x√°ch tay/ di ƒë·ªông'],
            'M√°y massage': ['M√°y massage c·∫ßm tay (gi·∫£m ƒëau c∆°)', 'ƒêai/ gh·∫ø massage to√†n th√¢n', 'M√°y massage ch√¢n (xoa b√≥p, l∆∞u th√¥ng m√°u)', 'Thi·∫øt b·ªã massage tr·ªã li·ªáu (nh∆∞ s√≥ng si√™u √¢m, laser c·∫•p th·∫•p)'],
            'Thi·∫øt b·ªã t·∫≠p': ['Thi·∫øt b·ªã t·∫≠p v·∫≠n ƒë·ªông th·ª• ƒë·ªông (CPM)', 'Thi·∫øt b·ªã t·∫≠p ƒëi/ thƒÉng b·∫±ng', 'Thi·∫øt b·ªã t·∫≠p ph·ª•c h·ªìi ch·ª©c nƒÉng tay/ ch√¢n', 'M√°y t·∫≠p th·ªÉ d·ª•c chuy√™n bi·ªát (xe ƒë·∫°p, treadmill cho ph·ª•c h·ªìi)', 'D·ª•ng c·ª• t·∫≠p tr·ªã li·ªáu (b√≥ng, d√¢y kh√°ng l·ª±c, t·∫° tay nh·∫π)'],
            'N·ªám': ['N·ªám ch·ªëng lo√©t (h∆°i, x·ªëp, gel)', 'N·ªám b·ªánh vi·ªán ti√™u chu·∫©n', 'N·ªám n√¢ng ƒë·ª° c∆° th·ªÉ (memory foam, cao su)'],
            'D·ª•ng c·ª• h·ªó tr·ª£': ['H·ªó tr·ª£ di chuy·ªÉn (khung t·∫≠p ƒëi, g·∫≠y ch·ªëng, n·∫°ng)', 'H·ªó tr·ª£ v·ªá sinh (b√¥ v·ªá sinh, b·ªìn c·∫ßu n√¢ng)', 'H·ªó tr·ª£ t·∫Øm (gh·∫ø t·∫Øm, th·∫£m ch·ªëng tr∆∞·ª£t)', 'H·ªó tr·ª£ m·∫∑c qu·∫ßn √°o', 'H·ªó tr·ª£ ƒÉn u·ªëng (th√¨a, ƒë≈©a, tay c·∫ßm ch·ªânh)'],
            'Thi·∫øt b·ªã y t·∫ø kh√°c': ['ƒê√®n kh√°m b·ªánh', 'M√°y kh·ª≠ rung tim (AED)', 'B∆°m ti√™m ƒëi·ªán', 'H·ªôp ƒë·ª±ng d·ª•ng c·ª• v√¥ tr√πng', 'V√† r·∫•t nhi·ªÅu thi·∫øt b·ªã chuy√™n s√¢u kh√°c']
        };
        
        function renderCategoryDetail(categoryName){
            const categoryDetail = document.getElementById('categoryDetail');
            if (!categoryDetail || !categoryData[categoryName]) return;
            const items = categoryData[categoryName];
            const itemsPerColumn = Math.ceil(items.length / 3);
            let columns = ['', '', ''];
            items.forEach((item, index) => {
                const columnIndex = Math.floor(index / itemsPerColumn);
                columns[columnIndex] += `<li class="detail-item" data-group="${categoryName}" data-type="${item}">${item}</li>`;
            });
            categoryDetail.innerHTML = `
                <div class="detail-column">
                    <h4>${categoryName}</h4>
                    <ul>${columns[0]}</ul>
                </div>
                <div class="detail-column">
                    <ul>${columns[1]}</ul>
                </div>
                <div class="detail-column">
                    <ul>${columns[2]}</ul>
                </div>
            `;
        }

        // Ch·ªâ d√πng click ƒë·ªÉ m·ªü chi ti·∫øt danh m·ª•c
        document.querySelectorAll('.submenu-content .brand-item').forEach(item => {
            item.addEventListener('click', function(e){
                e.preventDefault();
                const categoryName = this.getAttribute('data-category') || this.textContent.trim();
                renderCategoryDetail(categoryName);
            });
        });

        // Desktop hover detail click-through
        const detailEl = document.getElementById('categoryDetail');
        if (detailEl) {
            detailEl.addEventListener('click', function(e) {
                const li = e.target.closest('.detail-item');
                if (!li) return;
                const group = li.getAttribute('data-group') || '';
                const type = li.getAttribute('data-type') || '';
                const url = `quan-tri-vien-sanpham.html?groups=${encodeURIComponent(group)}&types=${encodeURIComponent(type)}`;
                window.location.href = url;
            });
        }

        // Mobile Dropdown Category Handling
        document.addEventListener('DOMContentLoaded', function() {
            const dropdownBtn = document.querySelector('.dropdown-btn');
            const dropdownContent = document.querySelector('.dropdown-content');
            const hasSubmenu = document.querySelector('.has-submenu');
            
            // L∆∞u HTML g·ªëc c·ªßa dropdown
            const originalDropdownHTML = dropdownContent.innerHTML;
            
            // Icon paths
            const categoryIcons = {
                'Gi∆∞·ªùng': 'icon-hinhdanhmuc/nhom-giuong.png',
                'Xe lƒÉn': 'icon-hinhdanhmuc/nhom-xelan.png',
                'Xe Scooter ƒëi·ªán': 'icon-hinhdanhmuc/nhom-xedien.png',
                'BƒÉng ca': 'icon-hinhdanhmuc/nhom-bangca.png',
                'T·ªß': 'icon-hinhdanhmuc/nhom-tu.png',
                'M√°y t·∫°o oxy': 'icon-hinhdanhmuc/nhom-maytaooxy.png',
                'M√°y ƒëo': 'icon-hinhdanhmuc/nhom-maydo.png',
                'M√°y x√¥ng': 'icon-hinhdanhmuc/nhom-xong.png',
                'M√°y h√∫t d·ªãch': 'icon-hinhdanhmuc/nhom-mayhutdich.png',
                'M√°y massage': 'icon-hinhdanhmuc/nhom-massage.png',
                'Thi·∫øt b·ªã t·∫≠p': 'icon-hinhdanhmuc/nhom-maytap.png',
                'N·ªám': 'icon-hinhdanhmuc/nhom-nem.png',
                'D·ª•ng c·ª• h·ªó tr·ª£': 'icon-hinhdanhmuc/nhom-dungcuhotro.png',
                'Thi·∫øt b·ªã y t·∫ø kh√°c': 'icon-hinhdanhmuc/nhom-thietbiyte.png'
            };
            
            // H√†m t·∫°o HTML cho danh m·ª•c s·∫£n ph·∫©m
            function createCategoryHTML() {
                let gridHTML = '<div class="sheet-category-grid">';
                
                Object.keys(categoryData).forEach(categoryName => {
                    const iconPath = categoryIcons[categoryName] || '';
                    gridHTML += `
                        <div class="sheet-category-item" data-category="${categoryName}">
                            <img src="${iconPath}" alt="${categoryName}" class="sheet-category-icon">
                            <span class="sheet-category-name">${categoryName}</span>
                        </div>
                    `;
                });
                
                gridHTML += '</div>';
                
                return `
                    <div class="dropdown-category-header">
                        <button class="dropdown-category-back">‚Äπ</button>
                        <h3>Danh m·ª•c s·∫£n ph·∫©m</h3>
                    </div>
                    <div class="dropdown-category-content">
                        ${gridHTML}
                    </div>
                `;
            }
            
            // X·ª≠ l√Ω click tr√™n dropdown (event delegation)
            dropdownContent.addEventListener('click', function(e) {
                e.stopPropagation();
                
                // N·∫øu click v√†o "S·∫£n ph·∫©m" tr√™n mobile
                if (window.innerWidth <= 768 && e.target.classList.contains('has-submenu')) {
                    e.preventDefault();
                    dropdownContent.innerHTML = createCategoryHTML();
                    dropdownContent.style.display = 'block';
                }
                // N·∫øu click v√†o n√∫t back
                else if (e.target.classList.contains('dropdown-category-back')) {
                    dropdownContent.innerHTML = originalDropdownHTML;
                    dropdownContent.style.display = 'block';
                    // G·∫Øn l·∫°i s·ª± ki·ªán cho dropdown m·ªõi
                    setTimeout(attachDropdownEvents, 0);
                }
                // N·∫øu click v√†o m·ªôt nh√≥m s·∫£n ph·∫©m
                else if (e.target.closest('.sheet-category-item')) {
                    const categoryItem = e.target.closest('.sheet-category-item');
                    const categoryName = categoryItem.getAttribute('data-category');
                    // ƒê√≥ng dropdown
                    dropdownContent.style.display = 'none';
                    // TODO: C√≥ th·ªÉ th√™m chuy·ªÉn h∆∞·ªõng ƒë·∫øn trang danh m·ª•c
                    console.log('Ch·ªçn danh m·ª•c:', categoryName);
                }
                // N·∫øu click v√†o c√°c link kh√°c (Trang ch·ªß, Gi·ªõi thi·ªáu, ...)
                else if (e.target.tagName === 'A' && e.target.getAttribute('href') && e.target.getAttribute('href') !== '#') {
                    // ƒê√≥ng dropdown
                    dropdownContent.style.display = 'none';
                }
            });
            
            // H√†m g·∫Øn s·ª± ki·ªán cho dropdown
            function attachDropdownEvents() {
                // ƒê·∫£m b·∫£o dropdown hi·ªÉn th·ªã ƒë√∫ng tr√™n mobile
                if (window.innerWidth <= 768) {
                    dropdownContent.style.position = 'fixed';
                    dropdownContent.style.top = '100px';
                    dropdownContent.style.left = '10px';
                    dropdownContent.style.right = '10px';
                    dropdownContent.style.width = 'calc(100% - 20px)';
                }
            }
            
            // X·ª≠ l√Ω n√∫t "Danh m·ª•c"
            if (dropdownBtn) {
                dropdownBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    if (dropdownContent.style.display === 'block') {
                        dropdownContent.style.display = 'none';
                    } else {
                        // Reset v·ªÅ menu ch√≠nh khi m·ªü dropdown
                        if (window.innerWidth <= 768) {
                            dropdownContent.innerHTML = originalDropdownHTML;
                            attachDropdownEvents();
                        }
                        dropdownContent.style.display = 'block';
                    }
                });
            }
            
            // ƒê√≥ng dropdown khi click ra ngo√†i
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.dropdown') && !e.target.closest('.dropdown-content')) {
                    dropdownContent.style.display = 'none';
                }
            });
            
            // Kh·ªüi t·∫°o
            attachDropdownEvents();
            
            // X·ª≠ l√Ω khi resize window
            window.addEventListener('resize', function() {
                if (window.innerWidth > 768) {
                    dropdownContent.innerHTML = originalDropdownHTML;
                    dropdownContent.style.position = '';
                    dropdownContent.style.top = '';
                    dropdownContent.style.left = '';
                    dropdownContent.style.right = '';
                    dropdownContent.style.width = '';
                    dropdownContent.style.display = '';
                } else {
                    attachDropdownEvents();
                }
            });
        });
    </script>   
    <section class="quote-section">
        <div class="container">
            <div class="quote-background">
                <div class="quote-content">
                    <div class="quote-left">
                        <h2>ƒêƒÇNG K√ù T∆Ø V·∫§N</h2>
                        <p>Nh·∫≠n t∆∞ v·∫•n mi·ªÖn ph√≠ t·ª´ ƒë·ªôi ng≈© chuy√™n gia.</p>
                    </div>
                    <div class="quote-form">
                        <form>
                            <div class="form-row">
                                <input type="text" placeholder="H·ªç v√† t√™n *" required>
                                <input type="tel" placeholder="S·ªë ƒëi·ªán tho·∫°i *" required>
                            </div>
                            <input type="email" placeholder="Email">
                            <textarea placeholder="N·ªôi dung c·∫ßn t∆∞ v·∫•n..."></textarea>
                            <button type="submit" class="quote-btn">G·ª¨I TH√îNG TIN</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>H·ªó tr·ª£ kh√°ch h√†ng</h3>
                    <ul>
                        <li>Hotline: 0937 043 808</li>
                        <li>(8-21h k·ªÉ c·∫£ T7, CN)</li>
                        <li>ƒêi·ªÅu kho·∫£n d·ªãch v·ª•</li>
                        <li>Ch√≠nh s√°ch ph·ª•c v·ª•</li>
                        <li>Ch√≠nh s√°ch ƒë·ªïi tr·∫£</li>
                        <li>Ch√≠nh s√°ch b·∫£o m·∫≠t</li>
                        <li>Ch√≠nh s√°ch v·∫≠n chuy·ªÉn</li>
                        <li>Ch√≠nh s√°ch thanh to√°n</li>
                        <li>Ch√≠nh s√°ch b·∫£o h√†nh</li>
                        <li>H·ªó tr·ª£ kh√°ch h√†ng: ducphuongmedical@gmail.com</li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3>B·∫£n tin s·ª©c kh·ªèe</h3>
                    <ul>
                        <li>Tin t·ª©c v·ªÅ gi∆∞·ªùng b·ªánh nh√¢n</li>
                        <li>H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng gi∆∞·ªùng b·ªánh</li>
                        <li>H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng xe lƒÉn ƒëi·ªán</li>
                        <li>Tin t·ª©c v·ªÅ m√°y t·∫°o Oxy</li>
                        <li>Tin t·ª©c v·ªÅ Xe LƒÉn</li>
                    </ul>
                    

                </div>
                
                <div class="footer-column">
                    <h3>Ph∆∞∆°ng th·ª©c thanh to√°n</h3>
                    <div class="payment-methods">
                        <img src="hinh-thanhtoan/visa.png" alt="Visa">
                        <img src="hinh-thanhtoan/mastercard.png" alt="Mastercard">
                        <img src="hinh-thanhtoan/jcb.png" alt="JCB">
                        <img src="hinh-thanhtoan/momo.png" alt="MoMo">
                    </div>
                    
                    <h4>D·ªãch v·ª• giao h√†ng</h4>
                    <div class="delivery-services">
                        <img src="hinh-anh/giao-hang.png" alt="Giao h√†ng">
                    </div>
                </div>
                
                <div class="footer-column">
                    <h3>K·∫øt n·ªëi v·ªõi ch√∫ng t√¥i</h3>
                    <div class="social-links">
                        <a href="https://www.facebook.com/ducphuongnguyenphuoctay" target="_blank">
                            <img src="hinh-anh/fb-logo.png" alt="Facebook">
                        </a>
                        <a href="https://youtube.com/@ducphuongmedical" target="_blank">
                            <img src="hinh-anh/youtube-icon.png" alt="YouTube">
                        </a>
                        <a href="https://zalo.me/0938.062.808" target="_blank">
                            <img src="hinh-anh/icon-zalo.png" alt="Zalo">
                        </a>
                        <a href="https://mail.google.com/mail/?view=cm&fs=1&to=ducphuongmedical@gmail.com" target="_blank">
                            <img src="hinh-anh/icon-gmail.png" alt="Gmail">
                        </a>
                    </div>
                    
                    <div class="certificates">
                        <h4>Ch·ª©ng nh·∫≠n b·ªüi</h4>
                        <div class="cert-logos">
                            <img src="hinh-anh/icon-ddk.png" alt="ƒê√£ ƒëƒÉng k√Ω">
                        </div>
                    </div>
                    

                </div>
            </div>
            
            <div class="footer-bottom">
                <div class="footer-bottom-content">
                    <div class="company-info">
                        <p>ƒê·ªãa ch·ªâ: 12 ƒê√¥ng H·ªì, Ph∆∞·ªùng 08, Qu·∫≠n T√¢n B√¨nh, TP.HCM</p>
                        <p>TaJerMy nh·∫≠n ƒë·∫∑t h√†ng tr·ª±c tuy·∫øn v√† giao h√†ng t·∫≠n n∆°i ho·∫∑c mua h√†ng tr·ª±c ti·∫øp t·∫°i c·ª≠a h√†ng</p>
                        <p>Gi·∫•y ch·ª©ng nh·∫≠n ƒêƒÉng k√Ω Kinh doanh s·ªë 0313717853 do S·ªü K·∫ø ho·∫°ch v√† ƒê·∫ßu t∆∞ Th√†nh ph·ªë H·ªì Ch√≠ Minh c·∫•p ng√†y 25/03/2016</p>
                        <p>&copy; 2022 - B·∫£n quy·ªÅn c·ªßa TaJerMy - www.ducphuongmedical.com. C·∫•m sao ch√©p d∆∞·ªõi m·ªçi h√¨nh th·ª©c n·∫øu kh√¥ng c√≥ s·ª± ch·∫•p thu·∫≠n b·∫±ng vƒÉn b·∫£n.</p>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <div class="phone-contact">
        <button class="admin-edit-btn" style="position: absolute; right: 70px; top: 15px;" onclick="openLinkEditModal('phone', this)">‚úèÔ∏è S·ª≠a</button>
        <a href="tel:0938062808" data-uid="contact-phone">
            <img src="hinh-anh/icon-dt.png" alt="ƒêi·ªán tho·∫°i">
        </a>
    </div>
    <div class="cskh-contact" onclick="toggleChat()">
        <img src="hinh-anh/icon-cskh.png" alt="CSKH">
        <span id="cskhBadge" style="display:none; position:absolute; top:-8px; right:-8px; background:#dc3545; color:#fff; border-radius:12px; padding:0 6px; font-size:12px; line-height:20px; min-width:20px; text-align:center;">0</span>
    </div>
        <style>
            /* ·∫®n n√∫t ch·ªânh s·ª≠a tr√™n n√∫t CSKH */
            .cskh-contact .admin-edit-btn { display: none !important; }
        
            .admin-chat-send {
                padding: 6px 15px;
                min-width: 5px;
                font-size: 15px;
                border-radius: 8px;
                color: #fff;
            }
            
            /* Customer avatar clickable */
            .customer-avatar-clickable {
                cursor: pointer;
                transition: transform 0.2s;
            }
            .customer-avatar-clickable:hover {
                transform: scale(1.1);
            }
        </style>
    <div class="zalo-contact">
        <button class="admin-edit-btn" style="position: absolute; right: 70px; top: 15px;" onclick="openLinkEditModal('zalo', this)">‚úèÔ∏è S·ª≠a</button>
        <a href="https://zalo.me/0938.062.808" target="_blank" data-uid="contact-zalo">
            <img src="hinh-anh/icon-zalo.png" alt="Zalo">
        </a>
    </div>
    <div class="youtube-contact">
        <button class="admin-edit-btn" style="position: absolute; right: 70px; top: 15px;" onclick="openLinkEditModal('youtube', this)">‚úèÔ∏è S·ª≠a</button>
        <a href="https://www.youtube.com/@ducphuongmedical" target="_blank" data-uid="contact-youtube">
            <img src="hinh-anh/youtube-icon.png" alt="YouTube">
        </a>
    </div>
    <div class="facebook-contact">
        <button class="admin-edit-btn" style="position: absolute; right: 70px; top: 15px;" onclick="openLinkEditModal('facebook', this)">‚úèÔ∏è S·ª≠a</button>
        <a href="https://www.facebook.com/ducphuongnguyenphuoctay" target="_blank" data-uid="contact-facebook">
            <img src="hinh-anh/fb-logo.png" alt="Facebook">
        </a>
    </div>
    
    <div class="chat-box" id="chatBox" style="display:none; position:fixed; right:20px; bottom:80px; width:820px; max-width:95vw; height:520px; max-height:70vh; background:#fff; border:1px solid #e5e7eb; border-radius:12px; box-shadow:0 8px 24px rgba(0,0,0,0.15); overflow:hidden; flex-direction:row;">
        <div class="chat-sidebar" style="width:280px; border-right:1px solid #eee; display:flex; flex-direction:column;">
            <div style="padding:10px; border-bottom:1px solid #eee; display:flex; gap:8px; align-items:center;">
                <input id="chatSearch" type="text" placeholder="T√¨m kh√°ch h√†ng..." style="flex:1; padding:8px 10px; border:1px solid #ddd; border-radius:8px;">
                <select id="chatFilter" style="padding:8px; border:1px solid #ddd; border-radius:8px;">
                    <option value="all">T·∫•t c·∫£</option>
                    <option value="unanswered">Ch∆∞a tr·∫£ l·ªùi</option>
                    <option value="new">C√≥ tin m·ªõi</option>
                </select>
            </div>
            <div id="chatList" style="flex:1; overflow:auto;">
                <!-- Conversations will render here -->
            </div>
        </div>
        <div class="chat-main" style="flex:1; display:flex; flex-direction:column;">
            <div class="chat-header" style="display:flex; align-items:center; gap:10px; padding:10px; border-bottom:1px solid #eee;">
                <div id="peerAvatarWrap" style="width:36px; height:36px; border-radius:50%; overflow:hidden; background:#f3f4f6;"></div>
                <div style="flex:1;">
                    <div id="peerName" style="font-weight:600;">Ch∆∞a ch·ªçn kh√°ch h√†ng</div>
                    <div id="peerStatus" style="font-size:12px; color:#6b7280;">Tr·∫°ng th√°i: -</div>
                </div>
                <button onclick="exportConversation()" class="admin-chat-send" style="background:#28a745">Xu·∫•t h·ªôi tho·∫°i</button>
                <button onclick="toggleChat()" class="admin-chat-send" style="background:#dc3545">ƒê√≥ng</button>
            </div>
            <div id="peerInfo" style="padding:8px 12px; border-bottom:1px solid #f3f4f6; font-size:12px; color:#374151; display:none"></div>
            <div id="chatThread" style="flex:1; overflow:auto; background:#fafafa; padding:10px 0;">
                <!-- Messages -->
            </div>
            <div id="typingIndicator" style="padding:6px 12px; font-size:12px; color:#6b7280; display:none">ƒêang nh·∫≠p...</div>
            <div class="chat-composer" style="display:flex; gap:8px; padding:10px; border-top:1px solid #eee; background:#fff; align-items:center;">
                <input type="text" id="chatInput" placeholder="Nh·∫≠p tin nh·∫Øn..." style="flex:1; padding:10px; border:1px solid #ddd; border-radius:8px;">
                <input type="file" id="chatFile" style="display:none">
                <button onclick="openFilePicker()" class="continue-btn" style="width:42px; height:42px; min-width:42px; padding:0; display:flex; align-items:center; justify-content:center; background:#f1f5f9; border:1px solid #e5e7eb;">
                    <img src="hinh-anh/icon-file.png" alt="T·ªáp" style="width:20px; height:20px; object-fit:contain;">
                </button>
                <button onclick="sendChatMessage()" class=" admin-chat-send" style="background:#0d6efd;">G·ª≠i</button>
            </div>
        </div>
    </div>
    
    <!-- Certificate Modal -->
    <div id="certModal" class="cert-modal">
        <div class="cert-modal-content">
            <span class="cert-close" onclick="closeCertModal()">&times;</span>
            <img id="certModalImg" src="" alt="">
        </div>
    </div>
    
    <!-- Modal Ch·ªânh s·ª≠a H√¨nh ·∫£nh -->
    <div id="imageEditModal" class="modal">
        <div class="modal-content image-edit-modal-content">
            <span class="close" onclick="closeImageEditModal()">&times;</span>
            <h2>Ch·ªânh s·ª≠a H√¨nh ·∫£nh</h2>
            
            <label for="imageFileInput">Ch·ªçn file t·ª´ m√°y t√≠nh</label>
            <input type="file" id="imageFileInput" accept="image/*" onchange="autoSelectExtension(); updatePathPreview();">
            
            <label for="imageFolderSelect">Th∆∞ m·ª•c l∆∞u tr·ªØ</label>
            <select id="imageFolderSelect" class="login-input" onchange="updatePathPreview()">
                <option value="hinh-anh/">hinh-anh/</option>
                <option value="hinh-san-pham/">hinh-san-pham/</option>
                <option value="hinh-du-an/">hinh-du-an/</option>
                <option value="hinh-chung-nhan/">hinh-chung-nhan/</option>
                <option value="hinh-trien-lam/">hinh-trien-lam/</option>
                <option value="hinh-xuong/">hinh-xuong/</option>
                <option value="hinh-thongtin/">hinh-thongtin/</option>
                <option value="custom">T√πy ch·ªânh...</option>
            </select>
            
            <div id="customFolderDiv" style="display: none; margin-top: 10px;">
                <label for="customFolderInput">ƒê∆∞·ªùng d·∫´n t√πy ch·ªânh</label>
                <input type="text" id="customFolderInput" class="login-input" placeholder="V√≠ d·ª•: uploads/images/" onchange="updatePathPreview()">
            </div>
            
            <label for="imageNameInput">T√™n file</label>
            <input type="text" id="imageNameInput" placeholder="Nh·∫≠p t√™n file (kh√¥ng c·∫ßn ƒëu√¥i)" onchange="updatePathPreview()">
            
            <label for="imageExtSelect">ƒêu√¥i file</label>
            <select id="imageExtSelect" class="login-input" onchange="updatePathPreview()">
                <option value=".jpg">.jpg</option>
                <option value=".jpeg">.jpeg</option>
                <option value=".png">.png</option>
                <option value=".gif">.gif</option>
                <option value=".webp">.webp</option>
                <option value=".svg">.svg</option>
                <option value=".bmp">.bmp</option>
            </select>
            
            <div id="pathPreview" style="margin-top: 10px; padding: 10px; background: #f0f0f0; border-radius: 5px; display: none;">
                <strong>File s·∫Ω ƒë∆∞·ª£c l∆∞u t·∫°i:</strong> <span id="pathPreviewText"></span>
            </div>
            
            <button class="continue-btn" onclick="uploadImage()" style="margin-top: 20px;">T·∫£i l√™n</button>
            
            <div id="progressContainer" class="progress-bar-container">
                <div id="uploadProgressBar" class="progress-bar">0%</div>
            </div>
            
            <button id="updateImageBtn" class="continue-btn" onclick="updateImage()" style="display: none;">C·∫≠p nh·∫≠t</button>
        </div>
    </div>
    
    <!-- Modal Ch·ªânh s·ª≠a VƒÉn b·∫£n -->
    <div id="textEditModal" class="modal">
        <div class="modal-content image-edit-modal-content">
            <span class="close" onclick="closeTextEditModal()">&times;</span>
            <h2>Ch·ªânh s·ª≠a VƒÉn b·∫£n</h2>
            
            <label for="textEditInput">N·ªôi dung vƒÉn b·∫£n</label>
            <textarea id="textEditInput" class="login-input" style="height: 100px; font-family: inherit;"></textarea>
            
            <button class="continue-btn" onclick="updateText()" style="margin-top: 20px; background-color: #28a745;">C·∫≠p nh·∫≠t</button>
        </div>
    </div>

    <!-- Modal Ch·ªânh s·ª≠a Li√™n k·∫øt -->
    <div id="linkEditModal" class="modal">
        <div class="modal-content image-edit-modal-content">
            <span class="close" onclick="closeLinkEditModal()">&times;</span>
            <h2 id="linkEditTitle">Ch·ªânh s·ª≠a Li√™n k·∫øt</h2>
            
            <label id="linkEditLabel" for="linkEditInput">Li√™n k·∫øt m·ªõi</label>
            <input type="text" id="linkEditInput" class="login-input">
            
            <button class="continue-btn" onclick="updateLink()" style="margin-top: 20px; background-color: #28a745;">C·∫≠p nh·∫≠t</button>
        </div>
    </div>

    <!-- Mobile Category Bottom Sheet -->
    <div class="sheet-overlay" id="sheetOverlay" onclick="closeMobileCategorySheet()"></div>
    <div class="mobile-category-sheet" id="mobileCategorySheet">
        <div class="sheet-header">
            <h3>Danh m·ª•c s·∫£n ph·∫©m</h3>
            <span class="sheet-close" onclick="closeMobileCategorySheet()">&times;</span>
        </div>
        <div class="sheet-content" id="sheetContent">
            <!-- Content will be populated by JavaScript -->
        </div>
    </div>
    
    <script>
        // ===== CSKH Admin Panel Logic (Two-way Chat) =====
        (function(){
            const chatBox = document.getElementById('chatBox');
            const badge = document.getElementById('cskhBadge');
            const chatList = document.getElementById('chatList');
            const chatThread = document.getElementById('chatThread');
            const chatInput = document.getElementById('chatInput');
            const chatFile = document.getElementById('chatFile');
            const peerInfo = document.getElementById('peerInfo');
            const peerName = document.getElementById('peerName');
            const peerStatus = document.getElementById('peerStatus');
            const peerAvatarWrap = document.getElementById('peerAvatarWrap');
            const typingIndicator = document.getElementById('typingIndicator');
            let currentPeerId = null;

            function api(action, payload){
                if (action === 'export') {
                    window.open('messages.php?action=export', '_blank');
                    return Promise.resolve();
                }
                const body = payload ? JSON.stringify(Object.assign({action}, payload)) : JSON.stringify({action});
                return fetch('/messages.php', { method: 'POST', headers: {'Content-Type':'application/json'}, body })
                    .then(r=>r.json());
            }

            function fmtTime(t){
                try { const d = new Date(t); return d.toLocaleString('vi-VN'); } catch { return t; }
            }

            let convData = [];
            function renderConversations(items){
                convData = items.slice();
                const q = (document.getElementById('chatSearch').value||'').toLowerCase();
                const filter = document.getElementById('chatFilter').value||'all';
                chatList.innerHTML = '';
                items.filter(it => {
                    const nameMatch = (it.peer_username||'').toLowerCase().includes(q);
                    let pass = nameMatch;
                    if (filter==='new') pass = pass && (it.unread_count||0)>0;
                    if (filter==='unanswered') pass = pass && (!it.last_content || it.last_content.trim().length===0);
                    return pass;
                }).forEach(it => {
                    const row = document.createElement('div');
                    row.className = 'chat-row';
                    row.style.display = 'grid';
                    row.style.gridTemplateColumns = '40px 1fr auto';
                    row.style.gap = '10px';
                    row.style.padding = '10px';
                    row.style.borderBottom = '1px solid #f3f4f6';
                    row.style.cursor = 'pointer';

                    const avatar = document.createElement('div');
                    avatar.style.width='40px'; avatar.style.height='40px'; avatar.style.borderRadius='50%'; avatar.style.background='#e5e7eb';
                    avatar.className = 'customer-avatar-clickable';
                    if (it.peer_avatar) { avatar.style.backgroundImage = `url(${it.peer_avatar})`; avatar.style.backgroundSize='cover'; }
                    avatar.addEventListener('click', (e) => { e.stopPropagation(); showCustomerInfo(it.peer_id); });

                    const mid = document.createElement('div');
                    const name = document.createElement('div'); name.textContent = it.peer_username || ('ID:'+it.peer_id); name.style.fontWeight='600';
                    const snippet = document.createElement('div'); snippet.textContent = (it.last_content||''); snippet.style.color='#6b7280'; snippet.style.fontSize='12px';
                    mid.appendChild(name); mid.appendChild(snippet);

                    const right = document.createElement('div'); right.style.textAlign='right';
                    const time = document.createElement('div'); time.textContent = fmtTime(it.last_time); time.style.fontSize='12px'; time.style.color='#6b7280';
                    const badgeEl = document.createElement('span'); if ((it.unread_count||0)>0){ badgeEl.textContent = it.unread_count; badgeEl.style.display='inline-block'; badgeEl.style.background='#dc3545'; badgeEl.style.color='#fff'; badgeEl.style.borderRadius='12px'; badgeEl.style.padding='0 6px'; badgeEl.style.fontSize='12px'; }
                    right.appendChild(time); right.appendChild(badgeEl);

                    row.appendChild(avatar); row.appendChild(mid); row.appendChild(right);
                    row.addEventListener('click', () => {
                        currentPeerId = it.peer_id;
                        loadMessages(currentPeerId);
                        updatePeerHeader(it);
                    });
                    chatList.appendChild(row);
                });
            }

            function updatePeerHeader(info){
                if (!info) return;
                peerName.textContent = info.peer_username || ('ID:'+info.peer_id);
                peerStatus.textContent = 'Tr·∫°ng th√°i: ' + (info.online ? 'Online' : 'Offline');
                peerAvatarWrap.style.background='#e5e7eb';
                peerAvatarWrap.style.backgroundImage = info.peer_avatar ? `url(${info.peer_avatar})` : '';
                peerAvatarWrap.style.backgroundSize='cover';

                if (info.meta) {
                    peerInfo.style.display = 'block';
                    peerInfo.textContent = 'Email: ' + (info.meta.email||'-') + ' ‚Ä¢ SƒêT: ' + (info.meta.phone||'-');
                } else {
                    peerInfo.style.display = 'none';
                    peerInfo.textContent = '';
                }
            }

            function renderMessage(m){
                const wrap = document.createElement('div');
                const isAdminSide = (m.sender_id === 0);
                wrap.style.display='flex'; wrap.style.padding='4px 12px'; wrap.style.justifyContent = isAdminSide ? 'flex-end' : 'flex-start';
                const bubble = document.createElement('div');
                bubble.style.maxWidth='80%'; bubble.style.padding='8px 10px'; bubble.style.borderRadius='12px';
                bubble.style.background = isAdminSide ? '#dbeafe' : '#fff'; bubble.style.border = '1px solid #e5e7eb';
                bubble.innerHTML = m.is_recalled ? '<em>Tin nh·∫Øn ƒë√£ ƒë∆∞·ª£c thu h·ªìi</em>' : (m.message_type==='text' ? (m.content||'') : (m.message_type==='image' ? `<img src="${m.attachment_path}" style="max-width:100%">` : (m.message_type==='file' ? `<a href="${m.attachment_path}" target="_blank">T·∫≠p tin</a>` : (m.message_type==='emoji' ? m.content : m.content))));
                const time = document.createElement('div');
                const ticks = (isAdminSide && m.status==='read') ? '‚úì‚úì' : (isAdminSide ? '‚úì' : '');
                time.textContent = fmtTime(m.created_at) + (ticks ? (' ‚Ä¢ ' + ticks) : '');
                time.style.fontSize='11px'; time.style.color='#6b7280'; time.style.marginTop='4px';
                bubble.appendChild(time);
                wrap.appendChild(bubble);
                return wrap;
            }

            function loadMessages(peerId){
                if (!peerId) return;
                api('list_messages', { peer_id: peerId, limit: 300 }).then(d => {
                    if (d.status==='success'){
                        chatThread.innerHTML='';
                        (d.messages||[]).forEach(m => chatThread.appendChild(renderMessage(m)));
                        chatThread.scrollTop = chatThread.scrollHeight;
                        api('mark_read_admin', { peer_id: peerId }).then(()=> poll());
                    }
                });
            }

            function loadConversations(){
                api('list_conversations', {}).then(d => {
                    if (d.status==='success'){
                        renderConversations(d.items||[]);
                        const totalUnread = (d.items||[]).reduce((sum,it)=> sum + (it.unread_count||0),0);
                        if (badge){
                            if (totalUnread>0){ badge.style.display='inline-block'; badge.textContent = totalUnread; }
                            else { badge.style.display='none'; }
                        }
                    }
                });
            }

            function poll(){ loadConversations(); }

            window.sendChatMessage = function(){
                if (!currentPeerId) return;
                const text = (chatInput.value||'').trim();
                const file = chatFile.files && chatFile.files[0];
                if (!text && !file) return;
                if (file){
                    const fd = new FormData(); fd.append('file', file);
                    fetch('/upload_chat_attachment.php', { method:'POST', body: fd }).then(r=>r.json()).then(res=>{
                        if (res.status==='success'){
                            return api('send', { receiver_id: currentPeerId, message_type:'image', attachment_path:res.path, content:'' });
                        } else { throw new Error('Upload th·∫•t b·∫°i'); }
                    }).then(()=>{ chatFile.value=''; loadMessages(currentPeerId); }).catch(()=> alert('Kh√¥ng th·ªÉ g·ª≠i t·ªáp.'));
                } else {
                    api('send', { receiver_id: currentPeerId, message_type:'text', content:text }).then(d=>{
                        if (d.status==='success'){
                            chatInput.value=''; loadMessages(currentPeerId);
                            if (ws && ws.readyState===1){ try { ws.send(JSON.stringify({type:'message', from:0, to: currentPeerId })); } catch {} }
                        }
                    });
                }
            };

            window.openFilePicker = function(){ chatFile && chatFile.click(); };

            window.exportConversation = function(){
                window.open('messages.php?action=export', '_blank');
            };

            // Override toggleChat to open/close and init data
            window.toggleChat = function(){
                if (!chatBox) return;
                const show = chatBox.style.display === 'none' || chatBox.style.display === '';
                chatBox.style.display = show ? 'flex' : 'none';
                if (show) { loadConversations(); if (currentPeerId) loadMessages(currentPeerId); }
            };

            // Remove any edit button over CSKH icon
            document.querySelectorAll('.cskh-contact .admin-edit-btn').forEach(el => el.remove());

            // WebSocket integration for real-time
            let ws;
            function connectWS(){
                try {
                    ws = new WebSocket('ws://localhost:9000');
                    ws.onopen = function(){
                        // Admin identity (id 0)
                        ws.send(JSON.stringify({type:'hello', sender_id:0, username:'Admin', role:'admin'}));
                    };
                    ws.onmessage = function(ev){
                        let msg = {}; try { msg = JSON.parse(ev.data); } catch { return; }
                        if (msg.type === 'message' && msg.to === 0) {
                            if (chatBox && chatBox.style.display !== 'none') {
                                if (currentPeerId && currentPeerId === msg.from) { loadMessages(currentPeerId); }
                            }
                            poll();
                        }
                        if (msg.type === 'typing' && currentPeerId && msg.from === currentPeerId) {
                            typingIndicator.style.display = msg.active ? 'block' : 'none';
                        }
                        if (msg.type === 'presence' && currentPeerId && msg.sender_id === currentPeerId) {
                            peerStatus.textContent = 'Tr·∫°ng th√°i: ' + (msg.online ? 'Online' : 'Offline');
                        }
                    };
                } catch (e) { /* ignore */ }
            }

            // Search & filter handlers
            const chatSearch = document.getElementById('chatSearch');
            const chatFilter = document.getElementById('chatFilter');
            chatSearch && chatSearch.addEventListener('input', () => renderConversations(convData));
            chatFilter && chatFilter.addEventListener('change', () => renderConversations(convData));

            // Start polling and WebSocket
            setInterval(poll, 8000);
            poll();
            connectWS();
        })();

        // Customer Info Modal Functions
        function showCustomerInfo(userId) {
            const modal = document.getElementById('customerInfoModal');
            if (!modal) return;
            modal.style.display = 'block';
            
            fetch(`messages.php?action=get_user_info&user_id=${userId}`)
            .then(r => r.text())
            .then(text => {
                try {
                    const data = JSON.parse(text);
                    if (data.status === 'success' && data.user) {
                        const user = data.user;
                        document.getElementById('customerName').textContent = user.username || '-';
                        document.getElementById('customerEmail').textContent = user.email || '-';
                        document.getElementById('customerPhone').textContent = user.phone || '-';
                        document.getElementById('customerId').textContent = user.id || '-';
                        document.getElementById('customerCreated').textContent = user.created_at || '-';
                    }
                } catch (e) {
                    console.error('Invalid JSON for customer info', e, text);
                }
            });
        }

        function closeCustomerInfoModal() {
            const modal = document.getElementById('customerInfoModal');
            if (modal) modal.style.display = 'none';
        }
        
        function openCertModal(imgSrc, altText) {
            const modal = document.getElementById('certModal');
            const modalImg = document.getElementById('certModalImg');
            modal.style.display = 'flex';
            modalImg.src = imgSrc;
            modalImg.alt = altText;
        }

        // M·ªü modal v√† reset tr·∫°ng th√°i
        function openImageEditModal(imgElement) {
            currentEditingImage = imgElement;
            const modal = document.getElementById('imageEditModal');
            
            // Reset form
            document.getElementById('imageFileInput').value = '';
            document.getElementById('imageNameInput').value = '';
            document.getElementById('progressContainer').style.display = 'none';
            document.getElementById('uploadProgressBar').style.width = '0%';
            document.getElementById('uploadProgressBar').innerText = '0%';
            document.getElementById('updateImageBtn').style.display = 'none';
            document.getElementById('pathPreview').style.display = 'none';
            document.getElementById('customFolderDiv').style.display = 'none';
            document.getElementById('updateImageBtn').removeAttribute('data-uploaded-path');
            
            // Reset progress bar color
            document.getElementById('uploadProgressBar').style.backgroundColor = '#4CAF50';
            
            // Load recent paths history
            loadRecentPaths();
            
            // Set default folder and extension
            document.getElementById('imageFolderSelect').value = 'hinh-anh/';
            document.getElementById('imageExtSelect').value = '.jpg';
            
            modal.style.display = 'block';
        }

        // ƒê√≥ng modal
        function closeImageEditModal() {
            document.getElementById('imageEditModal').style.display = 'none';
            currentEditingImage = null;
        }

        // Gi·∫£ l·∫≠p qu√° tr√¨nh t·∫£i l√™n
        function uploadImage() {
            const fileInput = document.getElementById('imageFileInput');
            if (fileInput.files.length === 0) {
                alert('Vui l√≤ng ch·ªçn m·ªôt file ƒë·ªÉ t·∫£i l√™n.');
                return;
            }
            
            // Validate path
            const fullPath = getFullPath();
            if (!validatePath(fullPath, true)) {
                return;
            }

            const progressContainer = document.getElementById('progressContainer');
            const progressBar = document.getElementById('uploadProgressBar');
            const updateBtn = document.getElementById('updateImageBtn');
            
            progressContainer.style.display = 'block';
            updateBtn.style.display = 'none';
            
            // T·∫°o FormData ƒë·ªÉ g·ª≠i file
            const formData = new FormData();
            formData.append('image', fileInput.files[0]);
            formData.append('folderPath', getFolderPath());
            formData.append('fileName', getFullPath().split('/').pop()); // L·∫•y t√™n file t·ª´ ƒë∆∞·ªùng d·∫´n ƒë·∫ßy ƒë·ªß
            
            // G·ª≠i file l√™n server
            const xhr = new XMLHttpRequest();
            
            // Theo d√µi ti·∫øn tr√¨nh upload
            xhr.upload.addEventListener('progress', function(e) {
                if (e.lengthComputable) {
                    const percentComplete = Math.round((e.loaded / e.total) * 100);
                    progressBar.style.width = percentComplete + '%';
                    progressBar.innerText = percentComplete + '%';
                }
            });
            
            // X·ª≠ l√Ω khi upload ho√†n t·∫•t
            xhr.addEventListener('load', function() {
                if (xhr.status === 200) {
                    try {
                        const response = JSON.parse(xhr.responseText);
                        if (response.status === 'success') {
                            progressBar.innerText = 'ƒê√£ l∆∞u file t·∫°i: ' + response.path;
                            updateBtn.style.display = 'block';
                            
                            // L∆∞u ƒë∆∞·ªùng d·∫´n ƒë·ªÉ s·ª≠ d·ª•ng khi c·∫≠p nh·∫≠t
                            updateBtn.setAttribute('data-uploaded-path', response.path);
                            
                            // Save to recent paths history
                            saveToRecentPaths(getFolderPath());
                        } else {
                            progressBar.innerText = 'L·ªói: ' + response.message;
                            progressBar.style.backgroundColor = '#dc3545';
                        }
                    } catch (e) {
                        progressBar.innerText = 'L·ªói x·ª≠ l√Ω ph·∫£n h·ªìi t·ª´ server';
                        progressBar.style.backgroundColor = '#dc3545';
                    }
                } else {
                    progressBar.innerText = 'L·ªói upload: ' + xhr.status;
                    progressBar.style.backgroundColor = '#dc3545';
                }
            });
            
            // X·ª≠ l√Ω l·ªói
            xhr.addEventListener('error', function() {
                progressBar.innerText = 'L·ªói k·∫øt n·ªëi ƒë·∫øn server';
                progressBar.style.backgroundColor = '#dc3545';
            });
            
            // G·ª≠i request
            xhr.open('POST', 'upload_image.php', true);
            xhr.send(formData);
        }

        // H√†m l∆∞u v√†o localStorage
        function saveContent(uid, value) {
            const savedData = JSON.parse(localStorage.getItem('siteContentThongTin') || '{}');
            savedData[uid] = value;
            localStorage.setItem('siteContentThongTin', JSON.stringify(savedData));
            
            // Dispatch event ƒë·ªÉ c√°c tab kh√°c (nh∆∞ thong-tin.html ƒëang m·ªü) c√≥ th·ªÉ c·∫≠p nh·∫≠t ngay l·∫≠p t·ª©c
            window.dispatchEvent(new StorageEvent('storage', { key: 'siteContentThongTin', newValue: JSON.stringify(savedData) }));
        }

        // X·ª≠ l√Ω khi nh·∫•n n√∫t C·∫≠p nh·∫≠t
        function updateImage() {
            if (currentEditingImage) {
                const updateBtn = document.getElementById('updateImageBtn');
                const uploadedPath = updateBtn.getAttribute('data-uploaded-path');
                
                if (!uploadedPath) {
                    alert('Vui l√≤ng t·∫£i file l√™n tr∆∞·ªõc khi c·∫≠p nh·∫≠t!');
                    return;
                }
                
                // C·∫≠p nh·∫≠t src c·ªßa ·∫£nh ƒëang s·ª≠a v·ªõi ƒë∆∞·ªùng d·∫´n th·ª±c t·ª´ server
                currentEditingImage.src = uploadedPath;
                
                // L∆∞u v√†o localStorage ƒë·ªÉ thong-tin.html c·∫≠p nh·∫≠t
                const uid = currentEditingImage.getAttribute('data-uid');
                if(uid) {
                    saveContent(uid, uploadedPath);
                }
                
                alert('ƒê√£ c·∫≠p nh·∫≠t h√¨nh ·∫£nh th√†nh c√¥ng!\nƒê∆∞·ªùng d·∫´n: ' + uploadedPath + '\n\n·∫¢nh ƒë√£ ƒë∆∞·ª£c l∆∞u tr√™n server v√† s·∫Ω hi·ªÉn th·ªã tr√™n c·∫£ 2 trang.');
                
                closeImageEditModal();
                
                // Reload ƒë·ªÉ hi·ªÉn th·ªã ·∫£nh m·ªõi
                setTimeout(() => {
                    location.reload();
                }, 500);
            }
        }

        // --- X·ª≠ l√Ω VƒÉn b·∫£n ---
        function openTextEditModal(textElement) {
            currentEditingText = textElement;
            const modal = document.getElementById('textEditModal');
            
            // Clone ph·∫ßn t·ª≠ ƒë·ªÉ l·∫•y text an to√†n m√† kh√¥ng c√≥ n√∫t "s·ª≠a"
            const clone = textElement.cloneNode(true);
            const btnInClone = clone.querySelector('.admin-edit-btn');
            if (btnInClone) {
                clone.removeChild(btnInClone);
            }
            const content = clone.innerText.trim();
            
            document.getElementById('textEditInput').value = content;
            modal.style.display = 'block';
        }

        function closeTextEditModal() {
            document.getElementById('textEditModal').style.display = 'none';
            currentEditingText = null;
        }

        function updateText() {
            if (currentEditingText) {
                const newText = document.getElementById('textEditInput').value;
                const uid = currentEditingText.getAttribute('data-uid');
                
                // T√¨m n√∫t s·ª≠a ƒë·ªÉ c√≥ th·ªÉ th√™m l·∫°i sau khi c·∫≠p nh·∫≠t innerText
                const editBtn = currentEditingText.querySelector('.admin-edit-btn');
                // C·∫≠p nh·∫≠t n·ªôi dung vƒÉn b·∫£n. Thao t√°c n√†y s·∫Ω x√≥a n√∫t "s·ª≠a" kh·ªèi DOM.
                currentEditingText.innerText = newText; 
                // Th√™m l·∫°i n√∫t "s·ª≠a" v√†o cu·ªëi
                if (editBtn) {
                    currentEditingText.appendChild(editBtn);
                }

                // L∆∞u v√†o localStorage
                if(uid) saveContent(uid, newText);

                alert('ƒê√£ c·∫≠p nh·∫≠t vƒÉn b·∫£n th√†nh c√¥ng!');
            }
            closeTextEditModal();
        }
        
        // --- Helper functions for path management ---
        function autoSelectExtension() {
            const fileInput = document.getElementById('imageFileInput');
            const extSelect = document.getElementById('imageExtSelect');
            
            if (fileInput.files.length > 0) {
                const fileName = fileInput.files[0].name;
                const ext = fileName.substring(fileName.lastIndexOf('.')).toLowerCase();
                
                // Try to match with available options
                const options = Array.from(extSelect.options);
                const matchingOption = options.find(opt => opt.value === ext);
                
                if (matchingOption) {
                    extSelect.value = ext;
                }
            }
        }
        
        function updatePathPreview() {
            const folderSelect = document.getElementById('imageFolderSelect');
            const customFolderDiv = document.getElementById('customFolderDiv');
            
            // Show/hide custom folder input
            if (folderSelect.value === 'custom') {
                customFolderDiv.style.display = 'block';
            } else {
                customFolderDiv.style.display = 'none';
            }
            
            const fullPath = getFullPath();
            if (fullPath) {
                document.getElementById('pathPreviewText').innerText = fullPath;
                document.getElementById('pathPreview').style.display = 'block';
            } else {
                document.getElementById('pathPreview').style.display = 'none';
            }
        }
        
        function getFolderPath() {
            const folderSelect = document.getElementById('imageFolderSelect');
            if (folderSelect.value === 'custom') {
                let customPath = document.getElementById('customFolderInput').value.trim();
                // Ensure it ends with /
                if (customPath && !customPath.endsWith('/')) {
                    customPath += '/';
                }
                return customPath;
            }
            return folderSelect.value;
        }
        
        function getFullPath() {
            const folderPath = getFolderPath();
            let fileName = document.getElementById('imageNameInput').value.trim();
            const fileInput = document.getElementById('imageFileInput');
            const extSelect = document.getElementById('imageExtSelect');
            
            if (!fileName && fileInput.files.length > 0) {
                // Use original filename if no name provided
                return folderPath + fileInput.files[0].name;
            } else if (fileName) {
                // Remove any extension from fileName if user typed it
                fileName = fileName.replace(/\.(jpg|jpeg|png|gif|bmp|webp|svg)$/i, '');
                // Add selected extension
                const ext = extSelect.value;
                return folderPath + fileName + ext;
            }
            return '';
        }
        
        function validatePath(path, showAlert = false) {
            if (!path) {
                if (showAlert) alert('Vui l√≤ng ch·ªçn file v√† nh·∫≠p t√™n file!');
                return false;
            }
            
            // Check for invalid characters
            const invalidChars = /[<>:"|?*]/;
            if (invalidChars.test(path)) {
                if (showAlert) alert('ƒê∆∞·ªùng d·∫´n ch·ª©a k√Ω t·ª± kh√¥ng h·ª£p l·ªá: < > : " | ? *');
                return false;
            }
            
            // Check if it has a valid image extension
            const validExtensions = /\.(jpg|jpeg|png|gif|bmp|webp|svg)$/i;
            if (!validExtensions.test(path)) {
                if (showAlert) alert('File ph·∫£i c√≥ ƒëu√¥i ·∫£nh h·ª£p l·ªá (.jpg, .png, .gif, .webp, .svg, .bmp)');
                return false;
            }
            
            return true;
        }
        
        function saveToRecentPaths(folderPath) {
            if (!folderPath) return;
            
            let recentPaths = JSON.parse(localStorage.getItem('recentImagePaths') || '[]');
            
            // Remove if already exists
            recentPaths = recentPaths.filter(p => p !== folderPath);
            
            // Add to front
            recentPaths.unshift(folderPath);
            
            // Keep only 5 most recent
            recentPaths = recentPaths.slice(0, 5);
            
            localStorage.setItem('recentImagePaths', JSON.stringify(recentPaths));
        }
        
        function loadRecentPaths() {
            const recentPaths = JSON.parse(localStorage.getItem('recentImagePaths') || '[]');
            const folderSelect = document.getElementById('imageFolderSelect');
            
            // Remove old recent options
            const options = folderSelect.querySelectorAll('option');
            options.forEach(opt => {
                if (opt.value.startsWith('recent-')) {
                    opt.remove();
                }
            });
            
            // Add recent paths before 'custom' option
            const customOption = folderSelect.querySelector('option[value="custom"]');
            recentPaths.forEach((path, index) => {
                // Check if not already in standard options
                const existingOption = Array.from(folderSelect.options).find(opt => opt.value === path);
                if (!existingOption && path !== 'custom') {
                    const option = document.createElement('option');
                    option.value = path;
                    option.textContent = 'üìå ' + path;
                    folderSelect.insertBefore(option, customOption);
                }
            });
        }

        // --- X·ª≠ l√Ω Li√™n k·∫øt ---
        let currentEditingLink = null;
        let currentLinkType = null;

        function openLinkEditModal(type, btnElement) {
            currentLinkType = type;
            // Find the <a> tag sibling
            const parent = btnElement.parentElement;
            const linkElement = parent.querySelector('a');
            currentEditingLink = linkElement;
            
            const modal = document.getElementById('linkEditModal');
            const title = document.getElementById('linkEditTitle');
            const label = document.getElementById('linkEditLabel');
            const input = document.getElementById('linkEditInput');
            
            let currentVal = linkElement.getAttribute('href');
            
            if (type === 'phone') {
                title.innerText = 'Ch·ªânh s·ª≠a s·ªë ƒëi·ªán tho·∫°i';
                label.innerText = 'S·ªë ƒëi·ªán tho·∫°i m·ªõi';
                // Remove 'tel:' prefix for display
                if (currentVal && currentVal.startsWith('tel:')) {
                    currentVal = currentVal.substring(4);
                }
            } else if (type === 'youtube') {
                title.innerText = 'Ch·ªânh s·ª≠a link YouTube';
                label.innerText = 'Link YouTube m·ªõi';
            } else if (type === 'zalo') {
                title.innerText = 'Ch·ªânh s·ª≠a link Zalo';
                label.innerText = 'Link Zalo m·ªõi';
            } else if (type === 'facebook') {
                title.innerText = 'Ch·ªânh s·ª≠a link Facebook';
                label.innerText = 'Link Facebook m·ªõi';
            }
            
            input.value = currentVal;
            modal.style.display = 'block';
        }

        function closeLinkEditModal() {
            document.getElementById('linkEditModal').style.display = 'none';
            currentEditingLink = null;
            currentLinkType = null;
        }

        function updateLink() {
            if (currentEditingLink && currentLinkType) {
                let newVal = document.getElementById('linkEditInput').value.trim();
                const uid = currentEditingLink.getAttribute('data-uid');
                
                if (currentLinkType === 'phone') {
                    // Ensure it has tel: prefix
                    let hrefVal = newVal;
                    if (!hrefVal.startsWith('tel:')) {
                        hrefVal = 'tel:' + hrefVal;
                    }
                    currentEditingLink.setAttribute('href', hrefVal);
                    
                    // Save the full href
                    if(uid) saveContent(uid, hrefVal);
                    
                } else {
                    // For others, just update href
                    currentEditingLink.setAttribute('href', newVal);
                    if(uid) saveContent(uid, newVal);
                }

                alert('ƒê√£ c·∫≠p nh·∫≠t li√™n k·∫øt th√†nh c√¥ng!');
            }
            closeLinkEditModal();
        }
        
        function closeCertModal() {
            document.getElementById('certModal').style.display = 'none';
        }

        function updateCarouselForMobile() {
            const isMobile = window.innerWidth <= 768;
            
            if (isMobile) {
                slidesToShow = 2; 
                maxIndex = totalItems - slidesToShow;
            } else {
                slidesToShow = 3; 
                maxIndex = totalItems - slidesToShow;
            }
            
            if (currentCarouselIndex > maxIndex) {
                currentCarouselIndex = maxIndex;
            }
            updateCarousel();
            updateCarouselButtons();
        }

        function updateCertForMobile() {
            const isMobile = window.innerWidth <= 768;
            const certItems = document.querySelectorAll('.certificate-item');
            
            if (isMobile) {
                maxCertIndex = certItems.length - 1;
            }
            updateCertificate();
        }

        window.addEventListener('load', function() {
            updateCarouselForMobile();
            updateCertForMobile();
        });

        window.addEventListener('resize', function() {
            updateCarouselForMobile();
            updateCertForMobile();
        });

        // Unified Dropdown & Mobile Menu Logic
        document.addEventListener('DOMContentLoaded', function() {
        const dropdown = document.querySelector('.dropdown');
        if (!dropdown) return;

        const dropdownBtn = dropdown.querySelector('.dropdown-btn');
        const dropdownContent = dropdown.querySelector('.dropdown-content');
        
        // Store the original HTML of the main menu
        const originalMenuHTML = dropdownContent.innerHTML;

        // Data for building category views
        const categoryIcons = {
            'Gi∆∞·ªùng': 'icon-hinhdanhmuc/nhom-giuong.png',
            'Xe lƒÉn': 'icon-hinhdanhmuc/nhom-xelan.png',
            'Xe Scooter ƒëi·ªán': 'icon-hinhdanhmuc/nhom-xedien.png',
            'BƒÉng ca': 'icon-hinhdanhmuc/nhom-bangca.png',
            'T·ªß': 'icon-hinhdanhmuc/nhom-tu.png',
            'M√°y t·∫°o oxy': 'icon-hinhdanhmuc/nhom-maytaooxy.png',
            'M√°y ƒëo': 'icon-hinhdanhmuc/nhom-maydo.png',
            'M√°y x√¥ng': 'icon-hinhdanhmuc/nhom-xong.png',
            'M√°y h√∫t d·ªãch': 'icon-hinhdanhmuc/nhom-mayhutdich.png',
            'M√°y massage': 'icon-hinhdanhmuc/nhom-massage.png',
            'Thi·∫øt b·ªã t·∫≠p': 'icon-hinhdanhmuc/nhom-maytap.png',
            'N·ªám': 'icon-hinhdanhmuc/nhom-nem.png',
            'D·ª•ng c·ª• h·ªó tr·ª£': 'icon-hinhdanhmuc/nhom-dungcuhotro.png',
            'Thi·∫øt b·ªã y t·∫ø kh√°c': 'icon-hinhdanhmuc/nhom-thietbiyte.png'
        };

        // Function to generate the HTML for the product categories grid
        function createProductCategoryHTML() {
            let gridHTML = '<div class="mobile-category-grid">';
            Object.keys(categoryData).forEach(categoryName => {
                const iconPath = categoryIcons[categoryName] || '';
                gridHTML += `
                    <div class="mobile-category-item" data-category="${categoryName}">
                        <img src="${iconPath}" alt="${categoryName}" class="mobile-category-icon">
                        <span>${categoryName}</span>
                    </div>
                `;
            });
            gridHTML += '</div>';

            return `
                <div class="mobile-menu-header">
                    <button class="mobile-menu-back-btn">‚Äπ Quay l·∫°i</button>
                    <h3>Danh m·ª•c s·∫£n ph·∫©m</h3>
                </div>
                ${gridHTML}
            `;
        }
        
        // Function to generate sub-category list
        function createSubCategoryHTML(categoryName) {
            const subcategories = categoryData[categoryName] || [];
            let listHTML = '';
            if (subcategories.length > 0) {
                subcategories.forEach(sub => {
                    listHTML += `<div class="mobile-subcategory-item">${sub}</div>`;
                });
            } else {
                listHTML = '<div>Kh√¥ng c√≥ s·∫£n ph·∫©m con.</div>';
            }

            return `
                <div class="mobile-menu-header">
                    <button class="mobile-menu-back-btn" data-target="main-categories">‚Äπ Danh m·ª•c</button>
                    <h3>${categoryName}</h3>
                </div>
                <div class="mobile-subcategory-list">${listHTML}</div>
            `;
        }

        // Main click handler for the "Danh m·ª•c" button
        dropdownBtn.addEventListener('click', function(event) {
            if (window.innerWidth <= 768) {
                event.preventDefault();
                event.stopPropagation();
                dropdown.classList.toggle('mobile-menu-active');
            }
        });

        // Event delegation for handling clicks inside the mobile menu
        dropdownContent.addEventListener('click', function(event) {
            if (window.innerWidth > 768) return; // Only run on mobile

            const target = event.target;

            // Click on "S·∫£n ph·∫©m" to show product categories
            if (target.matches('.has-submenu')) {
                event.preventDefault();
                dropdownContent.innerHTML = createProductCategoryHTML();
            }

            // Click on the "Back" button
            if (target.matches('.mobile-menu-back-btn')) {
                const backTarget = target.getAttribute('data-target');
                if (backTarget === 'main-categories') {
                     dropdownContent.innerHTML = createProductCategoryHTML();
                } else {
                     dropdownContent.innerHTML = originalMenuHTML;
                }
            }

            // Click on a main product category to see sub-categories
            const categoryItem = target.closest('.mobile-category-item');
            if (categoryItem) {
                const categoryName = categoryItem.getAttribute('data-category');
                if (categoryName) {
                    dropdownContent.innerHTML = createSubCategoryHTML(categoryName);
                }
            }
            
            // Clicking a subcategory item should eventually lead to a new page
            const subCategoryItem = target.closest('.mobile-subcategory-item');
            if (subCategoryItem) {
                console.log('Navigate to:', subCategoryItem.textContent);
                // Example: window.location.href = '/path/to/category';
                dropdown.classList.remove('mobile-menu-active'); // Close menu
            }
        });

        // Close mobile menu when clicking outside
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768) {
                if (!dropdown.contains(event.target)) {
                    dropdown.classList.remove('mobile-menu-active');
                }
            }
        });
        
         // Reset on resize
        window.addEventListener('resize', function() {
            dropdown.classList.remove('mobile-menu-active');
            dropdownContent.innerHTML = originalMenuHTML;
            // revert desktop hover behavior
            if (window.innerWidth > 768) {
                dropdownContent.style.display = '';
            }
        });
    });

    // Hi·ªáu ·ª©ng xu·∫•t hi·ªán t·ª´ t·ª´ (Reveal Animation)
    function reveal() {
        var reveals = document.querySelectorAll(".reveal");
        for (var i = 0; i < reveals.length; i++) {
            var windowHeight = window.innerHeight;
            var elementTop = reveals[i].getBoundingClientRect().top;
            var elementVisible = 50;
            if (elementTop < windowHeight - elementVisible) {
                reveals[i].classList.add("active");
            }
        }
    }
    window.addEventListener("scroll", reveal);
    // K√≠ch ho·∫°t ngay khi t·∫£i trang
    reveal();

    // Search functionality
    function removeVietnameseTones(str) {
        if (!str) return '';
        str = str.toLowerCase();
        str = str.replace(/√†|√°|·∫°|·∫£|√£|√¢|·∫ß|·∫•|·∫≠|·∫©|·∫´|ƒÉ|·∫±|·∫Ø|·∫∑|·∫≥|·∫µ/g, 'a');
        str = str.replace(/√®|√©|·∫π|·∫ª|·∫Ω|√™|·ªÅ|·∫ø|·ªá|·ªÉ|·ªÖ/g, 'e');
        str = str.replace(/√¨|√≠|·ªã|·ªâ|ƒ©/g, 'i');
        str = str.replace(/√≤|√≥|·ªç|·ªè|√µ|√¥|·ªì|·ªë|·ªô|·ªï|·ªó|∆°|·ªù|·ªõ|·ª£|·ªü|·ª°/g, 'o');
        str = str.replace(/√π|√∫|·ª•|·ªß|≈©|∆∞|·ª´|·ª©|·ª±|·ª≠|·ªØ/g, 'u');
        str = str.replace(/·ª≥|√Ω|·ªµ|·ª∑|·ªπ/g, 'y');
        str = str.replace(/ƒë/g, 'd');
        return str;
    }

    (function initSearch() {
        const searchInput = document.querySelector('.search-input');
        const searchBtn = document.querySelector('.search-btn');
        
        if (!searchInput || !searchBtn) return;
        
        searchBtn.addEventListener('click', () => {
            const query = searchInput.value.trim();
            if (query) {
                alert('T√¨m ki·∫øm: ' + query);
                // TODO: Implement search functionality for this page
            }
        });
        
        searchInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                const query = searchInput.value.trim();
                if (query) {
                    alert('T√¨m ki·∫øm: ' + query);
                    // TODO: Implement search functionality for this page
                }
            }
        });
    })();
    </script>
    <script src="search-suggestions.js"></script>
</body>
</html>